---
ms.date: 06/12/2017
keywords: jea, programu powershell, zabezpieczeń
title: Zagadnienia dotyczące zabezpieczeń JEA
ms.openlocfilehash: 46ea5cc3e9bc7b6759524aa466e900950a6dee26
ms.sourcegitcommit: 54534635eedacf531d8d6344019dc16a50b8b441
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/16/2018
---
# <a name="jea-security-considerations"></a><span data-ttu-id="a3e3f-103">Zagadnienia dotyczące zabezpieczeń JEA</span><span class="sxs-lookup"><span data-stu-id="a3e3f-103">JEA Security Considerations</span></span>

> <span data-ttu-id="a3e3f-104">Dotyczy: środowiska Windows PowerShell 5.0</span><span class="sxs-lookup"><span data-stu-id="a3e3f-104">Applies to: Windows PowerShell 5.0</span></span>

<span data-ttu-id="a3e3f-105">JEA pomaga zwiększyć strukturę bezpieczeństwa, zmniejszając liczbę administratorów trwałych na maszynach.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-105">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span>
<span data-ttu-id="a3e3f-106">Robi to przez utworzenie nowego punktu wejścia dla użytkowników do zarządzania systemem (Konfiguracja sesji programu PowerShell), który jest ściśle zablokowana domyślnie, aby uniemożliwić nadużycia.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-106">It does so by creating a new entry point for users to manage the system (a PowerShell session configuration) which is tightly locked down by default to prevent misuse.</span></span>
<span data-ttu-id="a3e3f-107">Użytkownicy, którzy potrzebują niektórych, ale nie nieograniczony dostęp do komputera, aby wykonywać zadania administracyjne można udzielić dostępu do punktu końcowego JEA.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-107">Users who need some, but not unlimited, access to the machine to perform administrative tasks can be granted access to the JEA endpoint.</span></span>
<span data-ttu-id="a3e3f-108">Ponieważ JEA pozwala na uruchamianie polecenia administratora bezpośrednio, bez dostępu administratora, możesz usunąć tych użytkowników z grup zabezpieczeń wysoko uprzywilejowane (były użytkownicy standardowi).</span><span class="sxs-lookup"><span data-stu-id="a3e3f-108">Because JEA allows them to run admin commands without directly having admin access, you can then remove those users from highly privileged security groups (make them standard users).</span></span>

<span data-ttu-id="a3e3f-109">W tym temacie opisano model zabezpieczeń JEA i najlepszych rozwiązań bardziej szczegółowo.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-109">This topic describes the JEA security model and best practices in more detail.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="a3e3f-110">Konto Uruchom jako</span><span class="sxs-lookup"><span data-stu-id="a3e3f-110">Run As account</span></span>

<span data-ttu-id="a3e3f-111">Każdy punkt końcowy JEA ma konto wyznaczonych "Uruchom jako", czyli konta, na którym użytkownik nawiązujący połączenie czynności.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-111">Each JEA endpoint has a designated "run as" account, which is the account under which the connecting user's actions are performed.</span></span>
<span data-ttu-id="a3e3f-112">To konto jest konfigurować w [pliku konfiguracji sesji](session-configurations.md), a konto, możesz wybrać ma znaczący wpływ na zabezpieczenia punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-112">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="a3e3f-113">**Kont wirtualnych** to zalecany sposób konfigurowania opcji Uruchom jako konta.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-113">**Virtual accounts** are the recommended way of configuring the run as account.</span></span>
<span data-ttu-id="a3e3f-114">Konta wirtualne są jednorazowe, tymczasowy kont lokalnych, które są tworzone dla użytkownik nawiązujący połączenie do użycia w okresie ich JEA sesji.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-114">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span>
<span data-ttu-id="a3e3f-115">Natychmiast po ich sesja została przerwana, konta wirtualnego zostaną usunięte i nie można już używać.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-115">As soon as their session is terminated, the virtual account will be destroyed and cannot be used anymore.</span></span>
<span data-ttu-id="a3e3f-116">Użytkownik nawiązujący połączenie nie może określić poświadczenia dla konta wirtualnego i nie można użyć konta wirtualnego do uzyskania dostępu do systemu za pomocą innych środków, takich jak Pulpit zdalny lub nieograniczonego punktu końcowego programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-116">The connecting user does not know the credentials for the virtual account and cannot use the virtual account to access the system via other means, such as Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="a3e3f-117">Domyślnie kont wirtualnych należy do lokalnej grupy administratorów na komputerze.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-117">By default, virtual accounts belong to the local administrators group on the machine.</span></span>
<span data-ttu-id="a3e3f-118">Dzięki temu ich pełnych praw do żadnych czynności w systemie zarządzania, jednak żadne prawa do zarządzania zasobami w sieci.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="a3e3f-119">Podczas uwierzytelniania z innych komputerów, z kontekstu użytkownika będzie konta komputera lokalnego, a nie konta wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-119">When authenticating with other machines, the user context will be that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="a3e3f-120">Kontrolery domeny są szczególnych przypadkach, ponieważ nie istnieje pojęcie grupy administratorów lokalnych.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-120">Domain controllers are a special case since there is no concept of a local administrators group.</span></span>
<span data-ttu-id="a3e3f-121">Zamiast tego konta wirtualne należą do administratorów domen i mogą zarządzać usługami katalogu na kontrolerze domeny.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-121">Instead, virtual accounts belong to Domain Admins instead and can manage the directory services on the domain controller.</span></span>
<span data-ttu-id="a3e3f-122">Tożsamość domeny jest nadal ograniczone do na kontrolerze domeny, w którym wystąpienia sesji JEA i dostępu do żadnych sieci pojawią się pochodzą z obiektu komputera kontrolera domeny, zamiast tego użyć.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-122">The domain identity is still restricted to use on the domain controller where the JEA session was instantiated, and any network access will appear to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="a3e3f-123">W obu przypadkach można również jawnie definiować które konta wirtualnego powinna należeć do grupy zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-123">In both cases, you can also explicitly define which security groups the virtual account should belong to.</span></span>
<span data-ttu-id="a3e3f-124">Jest dobrym rozwiązaniem, gdy zadanie, które są wykonywane mogą być przeprowadzane bez uprawnień administratora lokalnego/domeny.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-124">This is a good practice when the task you are performing can be done without local/domain admin privileges.</span></span>
<span data-ttu-id="a3e3f-125">Jeśli masz już grupę zabezpieczeń zdefiniowane dla administratorów, po prostu można przyznać wirtualnego konto do tej grupy, aby nadać mu uprawnienia, których potrzebuje.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-125">If you already have a security group defined for your admins, you can simply grant the virtual account membership to that group to give it the permissions it needs.</span></span>
<span data-ttu-id="a3e3f-126">Wirtualne członkostwa grupy konta jest ograniczona do grupy zabezpieczeń lokalnych na stacji roboczej lub na serwerze członkowskim, ale na kontrolerze domeny mogą być tylko członkami grupy zabezpieczeń domeny.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-126">Virtual account group membership is limited to local security groups on workstation and member servers, but on a domain controller they can only be members of domain security groups.</span></span>
<span data-ttu-id="a3e3f-127">Po określeniu jednej lub więcej grup zabezpieczeń dla konta wirtualnego należy do już będą należeć do grupy domyślne (administratora lokalnego lub administratora domeny).</span><span class="sxs-lookup"><span data-stu-id="a3e3f-127">Once you specify one or more security groups for the virtual account to belong to, it will no longer belong to the default groups (local admin or domain admin).</span></span>

<span data-ttu-id="a3e3f-128">Poniższa tabela zawiera podsumowanie opcji konfiguracji możliwe i wynikowy uprawnienia dla kont wirtualnych</span><span class="sxs-lookup"><span data-stu-id="a3e3f-128">The table below summarizes the possible configuration options and resulting permissions for virtual accounts</span></span>

<span data-ttu-id="a3e3f-129">Typ komputera</span><span class="sxs-lookup"><span data-stu-id="a3e3f-129">Computer type</span></span>                | <span data-ttu-id="a3e3f-130">Konfiguracja grupy Konto wirtualne</span><span class="sxs-lookup"><span data-stu-id="a3e3f-130">Virtual account group configuration</span></span> | <span data-ttu-id="a3e3f-131">Kontekst użytkownika lokalnego</span><span class="sxs-lookup"><span data-stu-id="a3e3f-131">Local user context</span></span>                                      | <span data-ttu-id="a3e3f-132">Kontekst użytkownika sieci</span><span class="sxs-lookup"><span data-stu-id="a3e3f-132">Network user context</span></span>
-----------------------------|-------------------------------------|---------------------------------------------------------|--------------------------------------------------
<span data-ttu-id="a3e3f-133">Kontroler domeny</span><span class="sxs-lookup"><span data-stu-id="a3e3f-133">Domain controller</span></span>            | <span data-ttu-id="a3e3f-134">Wartość domyślna</span><span class="sxs-lookup"><span data-stu-id="a3e3f-134">Default</span></span>                             | <span data-ttu-id="a3e3f-135">Użytkownik domeny, element członkowski "*domeny*\Domain</span><span class="sxs-lookup"><span data-stu-id="a3e3f-135">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="a3e3f-136">Konto komputera</span><span class="sxs-lookup"><span data-stu-id="a3e3f-136">Computer account</span></span>
<span data-ttu-id="a3e3f-137">Kontroler domeny</span><span class="sxs-lookup"><span data-stu-id="a3e3f-137">Domain controller</span></span>            | <span data-ttu-id="a3e3f-138">Grupy w domenie A i B</span><span class="sxs-lookup"><span data-stu-id="a3e3f-138">Domain groups A and B</span></span>               | <span data-ttu-id="a3e3f-139">Użytkownik domeny, element członkowski "*domeny*\A","*domeny*\B"</span><span class="sxs-lookup"><span data-stu-id="a3e3f-139">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="a3e3f-140">Konto komputera</span><span class="sxs-lookup"><span data-stu-id="a3e3f-140">Computer account</span></span>
<span data-ttu-id="a3e3f-141">Serwer członkowski lub stacji roboczej</span><span class="sxs-lookup"><span data-stu-id="a3e3f-141">Member server or workstation</span></span> | <span data-ttu-id="a3e3f-142">Wartość domyślna</span><span class="sxs-lookup"><span data-stu-id="a3e3f-142">Default</span></span>                             | <span data-ttu-id="a3e3f-143">Użytkownika lokalnego, element członkowski "*WBUDOWANE*\Administrators</span><span class="sxs-lookup"><span data-stu-id="a3e3f-143">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="a3e3f-144">Konto komputera</span><span class="sxs-lookup"><span data-stu-id="a3e3f-144">Computer account</span></span>
<span data-ttu-id="a3e3f-145">Serwer członkowski lub stacji roboczej</span><span class="sxs-lookup"><span data-stu-id="a3e3f-145">Member server or workstation</span></span> | <span data-ttu-id="a3e3f-146">Grupy lokalne C i D</span><span class="sxs-lookup"><span data-stu-id="a3e3f-146">Local groups C and D</span></span>                | <span data-ttu-id="a3e3f-147">Użytkownika lokalnego, element członkowski "*komputera*\C" i "*komputera*\D"</span><span class="sxs-lookup"><span data-stu-id="a3e3f-147">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="a3e3f-148">Konto komputera</span><span class="sxs-lookup"><span data-stu-id="a3e3f-148">Computer account</span></span>

<span data-ttu-id="a3e3f-149">Po wyświetleniu zdarzenia inspekcji zabezpieczeń i dzienniki zdarzeń aplikacji, zobaczysz, że każdej sesji użytkownika JEA ma unikatowe konto wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-149">When you look at security audit events and application event logs, you will see that each JEA user session has a unique virtual account.</span></span>
<span data-ttu-id="a3e3f-150">Ułatwia to śledzenie działań użytkownika w punkt końcowy JEA dla oryginalnego użytkownika, który uruchomił polecenie.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-150">This helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span>
<span data-ttu-id="a3e3f-151">Konto wirtualne nazwy zgodne format "Użytkownicy usługi WinRM wirtualnej\\WinRM\_VA\_*ACCOUNTNUMBER*\_*domeny* \_ *sAMAccountName*"na przykład, jeśli użytkownika"Alicja"w domenie"Contoso"ponowne uruchomienie usługi w punkt końcowy JEA, nazwę użytkownika skojarzoną z żadnych zdarzeń z Menedżera kontroli usług będzie" Użytkownicy wirtualnej WinRM\\WinRM\_ VA\_1\_contoso\_Alicja ".</span><span class="sxs-lookup"><span data-stu-id="a3e3f-151">Virtual account names follow the format "WinRM Virtual Users\\WinRM\_VA\_*ACCOUNTNUMBER*\_*DOMAIN*\_*sAMAccountName*" For example, if user "Alice" in domain "Contoso" restarts a service in a JEA endpoint, the username associated with any service control manager events would be "WinRM Virtual Users\\WinRM\_VA\_1\_contoso\_alice".</span></span>


<span data-ttu-id="a3e3f-152">**Grupa kont usług zarządzanych (Gmsa)** są przydatne, gdy serwer członkowski musi mieć dostęp do zasobów sieciowych w sesji JEA.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-152">**Group managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span>
<span data-ttu-id="a3e3f-153">Przykład przypadek użycia tego jest JEA punktu końcowego, który służy do kontrolowania dostępu do interfejsu API REST hostowany na innym komputerze.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-153">An example use case for this is a JEA endpoint that is used to control access to a REST API hosted on a different machine.</span></span>
<span data-ttu-id="a3e3f-154">Jest łatwy do zapisania tożsamości sieciowej potrzebne funkcje wprowadzić odpowiednie wywołania na interfejsu API REST, ale w celu uwierzytelnienia przy użyciu interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-154">It is easy to write functions to make the desired invocations on the REST API, but in order to authenticate with the API you need a network identity.</span></span>
<span data-ttu-id="a3e3f-155">Za pomocą konta usługi zarządzane przez grupę pozwala "drugi przeskok" przy zachowaniu kontroli nad którym komputery mogą używać konta.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-155">Using a group managed service account makes the "second hop" possible while still having control over which computers can use the account.</span></span>
<span data-ttu-id="a3e3f-156">Czynnych uprawnień przez grupę są definiowane przez grup zabezpieczeń (lokalnego lub domeny), do której należy konto usługi zarządzane przez grupę.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-156">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="a3e3f-157">Gdy punkt końcowy JEA jest skonfigurowany do używania konta gMSA, akcje wszyscy użytkownicy JEA pojawi się pochodzą z tej samej grupy zarządzane konto usługi.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-157">When a JEA endpoint is configured to use a gMSA account, the actions of all JEA users will appear to come from the same group managed service account.</span></span>
<span data-ttu-id="a3e3f-158">Jedynym sposobem można śledzić akcje do określonego użytkownika jest ustalenie zestaw poleceń, uruchom w wykazie sesji programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-158">The only way you can trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="a3e3f-159">**Do przekazywania poświadczeń** są używane, gdy nie określać Uruchom jako konta i chcesz programu PowerShell na potrzeby uruchamiania poleceń na serwerze zdalnym poświadczeń użytkownik nawiązujący połączenie.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-159">**Pass-thru credentials** are used when you do not specify a run as account and want PowerShell to use the connecting user's credential to run commands on the remote server.</span></span>
<span data-ttu-id="a3e3f-160">Ta konfiguracja jest *nie* zalecane dla JEA, ponieważ wymagałoby przyznania łączącego bezpośredni dostęp użytkownika do grupy zarządzania uprzywilejowanym.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-160">This configuration is *not* recommended for JEA as it would require you to grant the connecting user direct access to privileged management groups.</span></span>
<span data-ttu-id="a3e3f-161">Jeśli użytkownik nawiązujący połączenie ma już uprawnień administratora, mogą uniknąć JEA całkowicie i zarządzanie systemu za pośrednictwem innych nieograniczonego oznaczają.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-161">If the connecting user already has admin privileges, they can avoid JEA altogether and manage the system via other, unconstrained means.</span></span>
<span data-ttu-id="a3e3f-162">Zobacz poniższą sekcję na temat [JEA nie chroni przed Administratorzy](#jea-does-not-protect-against-admins) Aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-162">See the section below on how [JEA does not protect against admins](#jea-does-not-protect-against-admins) for more information.</span></span>

<span data-ttu-id="a3e3f-163">**Standardowa Uruchom jako konta** umożliwiają określenie dowolnego konta użytkownika, na którym będzie uruchamiana całej sesji programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-163">**Standard run as accounts** allow you to specify any user account under which the entire PowerShell session will run.</span></span>
<span data-ttu-id="a3e3f-164">Jest to ważna różnica, ponieważ zestaw konfiguracyjny sesji do użycia jako konto Uruchom stałego (z `-RunAsCredential` parametru) nie jest JEA-aware.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-164">This is an important distinction, because a session configuration set to use a fixed run as account (with the `-RunAsCredential` parameter) is not JEA-aware.</span></span>
<span data-ttu-id="a3e3f-165">Oznacza to, czy definicje ról przestaną działać zgodnie z oczekiwaniami i każdego użytkownika uprawnień dostępu punkt końcowy będzie można przypisać tego samego elementu role.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-165">That means that role definitions no longer function as expected, and every user authorized to access the endpoint will be assigned the same role.</span></span>

<span data-ttu-id="a3e3f-166">Nie należy używać RunAsCredential na punkt końcowy JEA z powodu trudności w śledzeniu akcje do konkretnych użytkowników i brak obsługi mapowanie użytkowników do ról.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-166">You should not use a RunAsCredential on a JEA endpoint because of the difficulty in tracing actions back to specific users and the lack of support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="a3e3f-167">Listę ACL punktów końcowych usługi WinRM</span><span class="sxs-lookup"><span data-stu-id="a3e3f-167">WinRM Endpoint ACL</span></span>

<span data-ttu-id="a3e3f-168">Z regularnych punktów końcowych usługi zdalne środowiska PowerShell, każdy punkt końcowy JEA ma osobne listy kontroli dostępu (ACL) w konfiguracji usługi WinRM, która kontroluje, który może uwierzytelniać z punktem końcowym JEA.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-168">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) set in the WinRM configuration that controls who can authenticate with the JEA endpoint.</span></span>
<span data-ttu-id="a3e3f-169">Jeśli niepoprawnie skonfigurowany Zaufani użytkownicy nie mogą mieć możliwość dostępu JEA punktu końcowego i/lub niezaufanych użytkownicy mogą uzyskać dostęp.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-169">If improperly configured, trusted users may not be able to access the JEA endpoint and/or untrusted users may gain access.</span></span>
<span data-ttu-id="a3e3f-170">Listy ACL usługi WinRM nie dotyczy jednak mapowanie użytkowników do ról JEA.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-170">The WinRM ACL does not, however, affect the mapping of users to JEA roles.</span></span>
<span data-ttu-id="a3e3f-171">Który jest kontrolowany przez *RoleDefinitions* w pliku konfiguracji sesji, który został zarejestrowany w systemie.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-171">That is controlled by the *RoleDefinitions* field in the session configuration file that was registered on the system.</span></span>

<span data-ttu-id="a3e3f-172">Domyślnie podczas rejestrowania punktu końcowego JEA przy użyciu pliku konfiguracji sesji i jeden lub więcej możliwości roli WinRM ACL zostanie skonfigurowana w celu zezwala wszystkim użytkownikom mapowanie na co najmniej jeden dostępu ról do punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-172">By default, when you register a JEA endpoint using a session configuration file and one or more role capabilities, the WinRM ACL will be configured to allow all users mapping to one or more roles access to the endpoint.</span></span>
<span data-ttu-id="a3e3f-173">Na przykład sesji JEA skonfigurowany za pomocą następujących poleceń będzie zezwalał na dostęp do *CONTOSO\JEA\_Lev1* i *CONTOSO\JEA\_Lev2*.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-173">For example, a JEA session configured using the following commands will grant full access to *CONTOSO\JEA\_Lev1* and *CONTOSO\JEA\_Lev2*.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="a3e3f-174">Można przeprowadzić inspekcję uprawnienia użytkownika z [Get-PSSessionConfiguration](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-174">You can audit user permissions with the [Get-PSSessionConfiguration](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
PS C:\> Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission

Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="a3e3f-175">Aby zmienić, którzy użytkownicy mają dostęp, uruchom `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` dla monitu interakcyjnego lub `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` można zaktualizować uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-175">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span>
<span data-ttu-id="a3e3f-176">Użytkownicy muszą mieć co najmniej *Invoke* prawa dostępu JEA punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-176">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="a3e3f-177">Jeśli dodatkowym użytkownikom udzielany jest dostęp do punktu końcowego JEA, ale nie należą do żadnych ról, zdefiniowanych w pliku konfiguracji sesji, będą oni mogli rozpocząć sesję JEA, ale tylko dostęp do poleceń cmdlet programu domyślnego.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-177">If additional users are granted access to the JEA endpoint but do not fall into any of the roles defined in the session configuration file, they will be able to start a JEA session but only have access to the default cmdlets.</span></span>
<span data-ttu-id="a3e3f-178">Uprawnienia użytkownika w punkcie końcowym JEA można inspekcji, uruchamiając `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-178">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span>
<span data-ttu-id="a3e3f-179">Zapoznaj się z [inspekcji i raportowania JEA](audit-and-report.md) artykule Aby uzyskać więcej informacji o inspekcji, które polecenia użytkownika ma dostęp do w punkt końcowy JEA.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-179">Check out the [Auditing and Reporting on JEA](audit-and-report.md) article for more information about auditing which commands a user has access to in a JEA endpoint.</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="a3e3f-180">Co najmniej uprawnień ról</span><span class="sxs-lookup"><span data-stu-id="a3e3f-180">Least privilege roles</span></span>

<span data-ttu-id="a3e3f-181">Podczas projektowania JEA ról, jest pamiętać, że wirtualne lub grupy usługi zarządzanej konta uruchomione w tle często ma nieograniczony dostęp do zarządzania na komputerze lokalnym.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-181">When designing JEA roles, it is important to remember that the virtual or group managed service account running behind the scenes often has unrestricted access to manage the local machine.</span></span>
<span data-ttu-id="a3e3f-182">Możliwości roli JEA ograniczyć co tego konta może służyć do dzięki ograniczeniu liczby poleceń i aplikacje, które mogą być uruchamiane przy użyciu tego kontekstu uprzywilejowanych.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-182">JEA role capabilities help restrict what that account can be used for by limiting the commands and applications that can be run using that privileged context.</span></span>
<span data-ttu-id="a3e3f-183">Nieprawidłowo zaprojektowane role umożliwiają niebezpiecznych polecenia do uruchomienia, które może zezwolić użytkownikowi na break poza granice JEA lub uzyskać dostępu do poufnych informacji.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-183">Improperly designed roles can allow dangerous commands to run that may allow a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="a3e3f-184">Rozważmy na przykład następujący wpis możliwości roli:</span><span class="sxs-lookup"><span data-stu-id="a3e3f-184">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="a3e3f-185">Ta możliwość roli pozwala użytkownikom na uruchamianie każdego polecenia cmdlet programu PowerShell z rzeczownik "Proces" z modułu Microsoft.PowerShell.Management.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-185">This role capability allows users to run any PowerShell cmdlet with the noun "Process" from the Microsoft.PowerShell.Management module.</span></span>
<span data-ttu-id="a3e3f-186">Użytkownicy mogą potrzebować dostępu do poleceń cmdlet, takich jak do `Get-Process` zrozumieć, jakie aplikacje są uruchomione w systemie i `Stop-Process` do żadnego kill zawiesił aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-186">Users may need to access cmdlets like `Get-Process` to understand what applications are running on the system and `Stop-Process` to kill any hung applications.</span></span>
<span data-ttu-id="a3e3f-187">Jednak umożliwia też ten wpis `Start-Process`, które mogą służyć do uruchomienia dowolnego programu z uprawnieniami administratora pełnego.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-187">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span>
<span data-ttu-id="a3e3f-188">Program nie wymaga lokalnie był zainstalowany w systemie, aby Atakujący dokonuje po prostu można uruchomić programu w udziale plików, zapewniająca łączącego użytkownikowi uprawnienia administratora lokalnego, uruchamia złośliwego oprogramowania i inne. "</span><span class="sxs-lookup"><span data-stu-id="a3e3f-188">The program doesn't need to be installed locally on the system, so an adversary could simply start a program on a file share that gives the connecting user local admin privileges, runs malware, and more.'</span></span>

<span data-ttu-id="a3e3f-189">Bezpieczniejsza wersja ta sama funkcja roli wyglądałyby tak jak:</span><span class="sxs-lookup"><span data-stu-id="a3e3f-189">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="a3e3f-190">Unikaj używania symboli wieloznacznych w roli możliwości i upewnij się, [inspekcji efektywne uprawnienia](audit-and-report.md#check-effective-rights-for-a-specific-user) regularnie, aby zrozumieć, które polecenia użytkownik ma dostęp do.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-190">Avoid using wildcards in role capabilities, and be sure to [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) regularly to understand which commands a user has access to.</span></span>

## <a name="jea-does-not-protect-against-admins"></a><span data-ttu-id="a3e3f-191">JEA nie chroni przed Administratorzy</span><span class="sxs-lookup"><span data-stu-id="a3e3f-191">JEA does not protect against admins</span></span>

<span data-ttu-id="a3e3f-192">Jeden z podstawowych zasad JEA jest możliwość z systemem innym niż administratorzy przeprowadzić *niektórych* zadania administracyjne.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-192">One of the core principles of JEA is that it allows non-admins to perform *some* admin tasks.</span></span>
<span data-ttu-id="a3e3f-193">JEA nie chroni przed tych, którzy już mają uprawnienia administratora.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-193">JEA does not protect against those who already have administrator privileges.</span></span>
<span data-ttu-id="a3e3f-194">Użytkownicy należącymi "Administratorzy domeny," "Administratorzy lokalni" lub innych grup wysoce uprzywilejowane w środowisku nadal będzie uda się rozwiązać przez JEA ochrony po zalogowaniu się do komputera za pośrednictwem innymi sposobami.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-194">Users who belong "domain admins," "local admins," or other highly privileged groups in your environment will still be able to get around JEA's protections by signing into the machine via another means.</span></span>
<span data-ttu-id="a3e3f-195">One można na przykład, zaloguj się przy użyciu protokołu RDP, Użyj zdalnego konsoli MMC lub Połącz z nieograniczonego punkty końcowe programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-195">They could, for example, sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span>
<span data-ttu-id="a3e3f-196">Administratorzy lokalni na komputerze można również zmodyfikować konfiguracje JEA umożliwia innym użytkownikom do zarządzania systemem lub zmień możliwość roli rozszerzyć zakres użytkownika czynności w ich JEA sesji.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-196">Local admins on the system can also modify JEA configurations to allow additional users to manage the system or change a role capability to extend the scope of what a user can do in their JEA session.</span></span>
<span data-ttu-id="a3e3f-197">W związku z tym należy ocenić użytkowników JEA uprawnienia rozszerzone aby zobaczyć, czy istnieją inne sposoby ich może uzyskać uprzywilejowany dostęp do systemu.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-197">It is therefore important to evaluate your JEA users' extended permissions to see if there are other ways they could gain privileged access to the system.</span></span>

<span data-ttu-id="a3e3f-198">Popularną praktyką jest JEA dla codziennej konserwacji i mieć "tylko w czasie" uprzywilejowany dostęp do rozwiązania do zarządzania umożliwiają użytkownikom tymczasowo stają się Administratorzy lokalni sytuacji awaryjnych.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-198">A common practice is to use JEA for regular day-to-day maintenance and have a "just in time" privileged access management solution allow users to temporarily become local admins in emergency situations.</span></span>
<span data-ttu-id="a3e3f-199">Dzięki temu użytkownicy nie są trwałe Administratorzy na komputerze, ale można uzyskać te prawa, jeśli i tylko wtedy, gdy ich zakończeniu przepływu pracy, który dokumentów ich użycie tych uprawnień.</span><span class="sxs-lookup"><span data-stu-id="a3e3f-199">This helps ensure users are not permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>