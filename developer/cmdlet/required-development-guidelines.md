---
title: Wymagane wskazówki dotyczące programowania | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 41d2b308-a36a-496f-8542-666b6a21eedc
caps.latest.revision: 19
ms.openlocfilehash: e68e43a91f9139e8d3dc636b5740121515aab2e6
ms.sourcegitcommit: 5a004064f33acc0145ccd414535763e95f998c89
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/23/2019
ms.locfileid: "69986679"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="f8994-102">Wskazówki dotyczące projektowania — użycie wymagane</span><span class="sxs-lookup"><span data-stu-id="f8994-102">Required Development Guidelines</span></span>

<span data-ttu-id="f8994-103">Podczas pisania poleceń cmdlet należy przestrzegać następujących wytycznych.</span><span class="sxs-lookup"><span data-stu-id="f8994-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="f8994-104">Są one podzielone na wytyczne dotyczące projektowania poleceń cmdlet i wytycznych dotyczących pisania kodu poleceń cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="f8994-105">Jeśli nie przestrzegasz tych wytycznych, polecenia cmdlet mogą zakończyć się niepowodzeniem, a użytkownicy mogą mieć słabe środowisko, gdy używają poleceń cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="f8994-106">W tym temacie</span><span class="sxs-lookup"><span data-stu-id="f8994-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="f8994-107">Wytyczne dotyczące projektowania</span><span class="sxs-lookup"><span data-stu-id="f8994-107">Design Guidelines</span></span>

- [<span data-ttu-id="f8994-108">Używaj tylko zatwierdzonych czasowników (RD01)</span><span class="sxs-lookup"><span data-stu-id="f8994-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="f8994-109">Nazwy poleceń cmdlet: Znaki, których nie można użyć (RD02)</span><span class="sxs-lookup"><span data-stu-id="f8994-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="f8994-110">Nazwy parametrów, których nie można użyć (RD03)</span><span class="sxs-lookup"><span data-stu-id="f8994-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="f8994-111">Obsługa żądań potwierdzenia (RD04)</span><span class="sxs-lookup"><span data-stu-id="f8994-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="f8994-112">Parametr Force obsługi dla sesji interakcyjnych (RD05)</span><span class="sxs-lookup"><span data-stu-id="f8994-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="f8994-113">Obiekty wyjściowe dokumentu (RD06)</span><span class="sxs-lookup"><span data-stu-id="f8994-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="f8994-114">Wskazówki dotyczące kodu</span><span class="sxs-lookup"><span data-stu-id="f8994-114">Code Guidelines</span></span>

- [<span data-ttu-id="f8994-115">Pochodne z klas poleceń cmdlet lub PSCmdlet (RC01)</span><span class="sxs-lookup"><span data-stu-id="f8994-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="f8994-116">Określ atrybut cmdlet (RC02)</span><span class="sxs-lookup"><span data-stu-id="f8994-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="f8994-117">Zastąp metodę przetwarzania danych wejściowych (RC03)</span><span class="sxs-lookup"><span data-stu-id="f8994-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="f8994-118">Określ atrybut OutputType (RC04)</span><span class="sxs-lookup"><span data-stu-id="f8994-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="f8994-119">Nie zachowuj dojść do obiektów wyjściowych (RC05)</span><span class="sxs-lookup"><span data-stu-id="f8994-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="f8994-120">Niezawodna obsługa błędów (RC06)</span><span class="sxs-lookup"><span data-stu-id="f8994-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="f8994-121">Wdrażanie poleceń cmdlet przy użyciu modułu programu Windows PowerShell (RC07)</span><span class="sxs-lookup"><span data-stu-id="f8994-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="f8994-122">Wytyczne dotyczące projektowania</span><span class="sxs-lookup"><span data-stu-id="f8994-122">Design Guidelines</span></span>

<span data-ttu-id="f8994-123">Podczas projektowania poleceń cmdlet w celu zapewnienia spójnego środowiska użytkownika między użyciem poleceń cmdlet i innych poleceń cmdlet należy przestrzegać następujących wytycznych.</span><span class="sxs-lookup"><span data-stu-id="f8994-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="f8994-124">Po znalezieniu wytycznych dotyczących projektowania, które dotyczą danej sytuacji, należy zapoznać się z wytycznymi dotyczącymi kodu dotyczącymi podobnych wytycznych.</span><span class="sxs-lookup"><span data-stu-id="f8994-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="f8994-125">Używaj tylko zatwierdzonych czasowników (RD01)</span><span class="sxs-lookup"><span data-stu-id="f8994-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="f8994-126">Czasownik określony w atrybucie polecenia cmdlet musi pochodzić z rozpoznanego zestawu czasowników udostępnianych przez program Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f8994-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="f8994-127">Nie może być jednym z zabronionych synonimów.</span><span class="sxs-lookup"><span data-stu-id="f8994-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="f8994-128">Użyj stałych ciągów, które są zdefiniowane przez następujące wyliczenia, aby określić czasowniki poleceń cmdlet:</span><span class="sxs-lookup"><span data-stu-id="f8994-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="f8994-129">System. Management. Automation. VerbsCommon</span><span class="sxs-lookup"><span data-stu-id="f8994-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="f8994-130">System. Management. Automation. VerbsCommunications</span><span class="sxs-lookup"><span data-stu-id="f8994-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="f8994-131">System. Management. Automation. VerbsData</span><span class="sxs-lookup"><span data-stu-id="f8994-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="f8994-132">System. Management. Automation. VerbsDiagnostic</span><span class="sxs-lookup"><span data-stu-id="f8994-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="f8994-133">System. Management. Automation. VerbsLifeCycle</span><span class="sxs-lookup"><span data-stu-id="f8994-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="f8994-134">System. Management. Automation. VerbsSecurity</span><span class="sxs-lookup"><span data-stu-id="f8994-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="f8994-135">System. Management. Automation. VerbsOther</span><span class="sxs-lookup"><span data-stu-id="f8994-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="f8994-136">Aby uzyskać więcej informacji na temat zatwierdzonych nazw zleceń, zobacz [czasowniki poleceń cmdlet](./approved-verbs-for-windows-powershell-commands.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="f8994-137">Użytkownicy potrzebują zestawu odnajdywania i oczekiwanych nazw poleceń cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="f8994-138">Użyj odpowiedniego zlecenia, aby użytkownik mógł szybko ocenić działanie polecenia cmdlet i łatwo poznać możliwości systemu.</span><span class="sxs-lookup"><span data-stu-id="f8994-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="f8994-139">Na przykład następujące polecenie wiersza polecenia pobiera listę wszystkich poleceń w systemie, których nazwy zaczynają się od "Start": `get-command start-*`.</span><span class="sxs-lookup"><span data-stu-id="f8994-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="f8994-140">Użyj rzeczowników w poleceniach cmdlet, aby odróżnić polecenia cmdlet od innych poleceń cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="f8994-141">Rzeczownik wskazuje zasób, na którym operacja zostanie wykonana.</span><span class="sxs-lookup"><span data-stu-id="f8994-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="f8994-142">Sama operacja jest reprezentowana przez zlecenie.</span><span class="sxs-lookup"><span data-stu-id="f8994-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="f8994-143">Nazwy poleceń cmdlet: Znaki, których nie można użyć (RD02)</span><span class="sxs-lookup"><span data-stu-id="f8994-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="f8994-144">Podczas nazwy poleceń cmdlet nie należy używać żadnego z następujących znaków specjalnych.</span><span class="sxs-lookup"><span data-stu-id="f8994-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="f8994-145">Znak</span><span class="sxs-lookup"><span data-stu-id="f8994-145">Character</span></span>|<span data-ttu-id="f8994-146">Nazwa</span><span class="sxs-lookup"><span data-stu-id="f8994-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="f8994-147">znak numeru</span><span class="sxs-lookup"><span data-stu-id="f8994-147">number sign</span></span>|
|<span data-ttu-id="f8994-148">,</span><span class="sxs-lookup"><span data-stu-id="f8994-148">,</span></span>|<span data-ttu-id="f8994-149">pliku</span><span class="sxs-lookup"><span data-stu-id="f8994-149">comma</span></span>|
|<span data-ttu-id="f8994-150">()</span><span class="sxs-lookup"><span data-stu-id="f8994-150">()</span></span>|<span data-ttu-id="f8994-151">nawiasów</span><span class="sxs-lookup"><span data-stu-id="f8994-151">parentheses</span></span>|
|{}|<span data-ttu-id="f8994-152">nawiasy klamrowe</span><span class="sxs-lookup"><span data-stu-id="f8994-152">braces</span></span>|
|<span data-ttu-id="f8994-153">[]</span><span class="sxs-lookup"><span data-stu-id="f8994-153">[]</span></span>|<span data-ttu-id="f8994-154">nawias</span><span class="sxs-lookup"><span data-stu-id="f8994-154">brackets</span></span>|
|&|<span data-ttu-id="f8994-155">znaku</span><span class="sxs-lookup"><span data-stu-id="f8994-155">ampersand</span></span>|
|-|<span data-ttu-id="f8994-156">**Uwaga dotycząca** łącznika:  Łącznik może służyć do oddzielania czasownika od rzeczownika, ale nie może być używany w rzeczowniku lub w czasowniku.</span><span class="sxs-lookup"><span data-stu-id="f8994-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="f8994-157">znak ukośnika</span><span class="sxs-lookup"><span data-stu-id="f8994-157">slash mark</span></span>|
|<span data-ttu-id="f8994-158">\\| ukośnik odwrotny</span><span class="sxs-lookup"><span data-stu-id="f8994-158">\\|backslash</span></span>|
|$|<span data-ttu-id="f8994-159">znak dolara</span><span class="sxs-lookup"><span data-stu-id="f8994-159">dollar sign</span></span>|
|^|<span data-ttu-id="f8994-160">użyciu</span><span class="sxs-lookup"><span data-stu-id="f8994-160">caret</span></span>|
|<span data-ttu-id="f8994-161">;</span><span class="sxs-lookup"><span data-stu-id="f8994-161">;</span></span>|<span data-ttu-id="f8994-162">Dziel</span><span class="sxs-lookup"><span data-stu-id="f8994-162">semicolon</span></span>|
|<span data-ttu-id="f8994-163">:</span><span class="sxs-lookup"><span data-stu-id="f8994-163">:</span></span>|<span data-ttu-id="f8994-164">średnikami</span><span class="sxs-lookup"><span data-stu-id="f8994-164">colon</span></span>|
|<span data-ttu-id="f8994-165">"</span><span class="sxs-lookup"><span data-stu-id="f8994-165">"</span></span>|<span data-ttu-id="f8994-166">podwójny cudzysłów</span><span class="sxs-lookup"><span data-stu-id="f8994-166">double quotation mark</span></span>|
|<span data-ttu-id="f8994-167">'</span><span class="sxs-lookup"><span data-stu-id="f8994-167">'</span></span>|<span data-ttu-id="f8994-168">znak pojedynczego cudzysłowu</span><span class="sxs-lookup"><span data-stu-id="f8994-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="f8994-169">nawiasy kątowe</span><span class="sxs-lookup"><span data-stu-id="f8994-169">angle brackets</span></span>|
|<span data-ttu-id="f8994-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="f8994-170">&#124;</span></span>|<span data-ttu-id="f8994-171">pionowy pasek</span><span class="sxs-lookup"><span data-stu-id="f8994-171">vertical bar</span></span>|
|<span data-ttu-id="f8994-172">?</span><span class="sxs-lookup"><span data-stu-id="f8994-172">?</span></span>|<span data-ttu-id="f8994-173">znak zapytania</span><span class="sxs-lookup"><span data-stu-id="f8994-173">question mark</span></span>|
|@|<span data-ttu-id="f8994-174">przy podpisaniu</span><span class="sxs-lookup"><span data-stu-id="f8994-174">at sign</span></span>|
|`|<span data-ttu-id="f8994-175">Wróć do osi (akcent słaby)</span><span class="sxs-lookup"><span data-stu-id="f8994-175">back tick (grave accent)</span></span>|
|*|<span data-ttu-id="f8994-176">znaku</span><span class="sxs-lookup"><span data-stu-id="f8994-176">asterisk</span></span>|
|%|<span data-ttu-id="f8994-177">znak procentu</span><span class="sxs-lookup"><span data-stu-id="f8994-177">percent sign</span></span>|
|+|<span data-ttu-id="f8994-178">znak plus</span><span class="sxs-lookup"><span data-stu-id="f8994-178">plus sign</span></span>|
|=|<span data-ttu-id="f8994-179">znak równości</span><span class="sxs-lookup"><span data-stu-id="f8994-179">equals sign</span></span>|
|~|<span data-ttu-id="f8994-180">tyld</span><span class="sxs-lookup"><span data-stu-id="f8994-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="f8994-181">Nazwy parametrów, których nie można użyć (RD03)</span><span class="sxs-lookup"><span data-stu-id="f8994-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="f8994-182">Środowisko Windows PowerShell udostępnia wspólny zestaw parametrów dla wszystkich poleceń cmdlet oraz dodatkowe parametry, które są dodawane w określonych sytuacjach.</span><span class="sxs-lookup"><span data-stu-id="f8994-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="f8994-183">Podczas projektowania własnych poleceń cmdlet nie można używać następujących nazw: Confirm, Debug, ErrorAction, ErrorVariable, subbuffer, subvariable, WarningAction, WarningVariable, WhatIf, UseTransaction i verbose.</span><span class="sxs-lookup"><span data-stu-id="f8994-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="f8994-184">Aby uzyskać więcej informacji na temat tych parametrów, zobacz [Common](./common-parameter-names.md)Parameters Names.</span><span class="sxs-lookup"><span data-stu-id="f8994-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="f8994-185">Obsługa żądań potwierdzenia (RD04)</span><span class="sxs-lookup"><span data-stu-id="f8994-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="f8994-186">W przypadku poleceń cmdlet, które wykonują operację modyfikującą system, powinny wywołać metodę [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) , aby zażądać potwierdzenia, a w szczególnych przypadkach wywołać [ Metoda System. Management. Automation. cmdlet. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="f8994-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="f8994-187">(Metoda [System. Management. Automation. cmdlet. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) powinna być wywoływana tylko po wywołaniu metody [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) ).</span><span class="sxs-lookup"><span data-stu-id="f8994-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="f8994-188">Aby wykonać te wywołania, polecenie cmdlet musi określić, że obsługuje żądania potwierdzenia przez ustawienie `SupportsShouldProcess` słowa kluczowego dla atrybutu cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="f8994-189">Aby uzyskać więcej informacji na temat ustawiania tego atrybutu, zobacz [polecenie cmdlet Attribute deklaracji](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="f8994-190">Jeśli atrybut cmdlet klasy cmdlet wskazuje, że polecenie cmdlet obsługuje wywołania do metody [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) , a polecenie cmdlet nie może wykonać wywołania [ System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) Metoda, użytkownik może nieoczekiwanie modyfikować system.</span><span class="sxs-lookup"><span data-stu-id="f8994-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="f8994-191">Użyj metody [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) do modyfikacji systemu.</span><span class="sxs-lookup"><span data-stu-id="f8994-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="f8994-192">Preferencja użytkownika i `WhatIf` parametr sterują metodą [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) .</span><span class="sxs-lookup"><span data-stu-id="f8994-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="f8994-193">Z kolei wywołanie metody [System. Management. Automation. cmdlet. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) wykonuje dodatkowe sprawdzenie pod kątem potencjalnie niebezpiecznych modyfikacji.</span><span class="sxs-lookup"><span data-stu-id="f8994-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="f8994-194">Ta metoda nie jest kontrolowana przez żadną preferencję użytkownika `WhatIf` ani parametr.</span><span class="sxs-lookup"><span data-stu-id="f8994-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="f8994-195">Jeśli polecenie cmdlet wywołuje metodę [System. Management. Automation. cmdlet. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) , powinna mieć `Force` parametr, który pomija wywołania tych dwóch metod, i które kontynuuje wykonywanie operacji.</span><span class="sxs-lookup"><span data-stu-id="f8994-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="f8994-196">Jest to ważne, ponieważ umożliwia używanie polecenia cmdlet w skryptach i hostach, które nie są interaktywne.</span><span class="sxs-lookup"><span data-stu-id="f8994-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="f8994-197">Jeśli polecenia cmdlet obsługują te wywołania, użytkownik może określić, czy akcja powinna być faktycznie wykonywana.</span><span class="sxs-lookup"><span data-stu-id="f8994-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="f8994-198">Na przykład polecenie cmdlet [stop-Process](/powershell/module/microsoft.powershell.management/stop-process) wywołuje metodę [System. Management. Automation. cmdlet. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) przed zatrzymaniem zestawu krytycznych procesów, w tym procesów system, Winlogon i Spoolsv.</span><span class="sxs-lookup"><span data-stu-id="f8994-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="f8994-199">Aby uzyskać więcej informacji na temat obsługi tych metod, zobacz [żądanie potwierdzenia](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="f8994-200">Parametr Force obsługi dla sesji interakcyjnych (RD05)</span><span class="sxs-lookup"><span data-stu-id="f8994-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="f8994-201">Jeśli polecenie cmdlet jest używane interaktywnie, należy zawsze dostarczyć parametr Force, aby przesłonić akcje interaktywne, takie jak monity lub odczytywanie wierszy danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="f8994-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="f8994-202">Jest to ważne, ponieważ umożliwia używanie polecenia cmdlet w skryptach i hostach, które nie są interaktywne.</span><span class="sxs-lookup"><span data-stu-id="f8994-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="f8994-203">Host interaktywny może implementować następujące metody.</span><span class="sxs-lookup"><span data-stu-id="f8994-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="f8994-204">System. Management. Automation. host. PSHostUserInterface. Prompt \*</span><span class="sxs-lookup"><span data-stu-id="f8994-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="f8994-205">System. Management. Automation. host. Pshostuserinterface. PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="f8994-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="f8994-206">System. Management. Automation. host. Ihostuisupportsmultiplechoiceselection. PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="f8994-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="f8994-207">System. Management. Automation. host. Pshostuserinterface. PromptForCredential \*</span><span class="sxs-lookup"><span data-stu-id="f8994-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="f8994-208">System. Management. Automation. host. Pshostuserinterface. ReadLine \*</span><span class="sxs-lookup"><span data-stu-id="f8994-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="f8994-209">System. Management. Automation. host. Pshostuserinterface. ReadLineAsSecureString \*</span><span class="sxs-lookup"><span data-stu-id="f8994-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="f8994-210">Obiekty wyjściowe dokumentu (RD06)</span><span class="sxs-lookup"><span data-stu-id="f8994-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="f8994-211">Program Windows PowerShell korzysta z obiektów, które są zapisywane w potoku.</span><span class="sxs-lookup"><span data-stu-id="f8994-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="f8994-212">Aby użytkownicy mogli korzystać z obiektów, które są zwracane przez poszczególne polecenia cmdlet, należy udokumentować obiekty, które są zwracane, i należy udokumentować, do czego są używane elementy zwracanych obiektów.</span><span class="sxs-lookup"><span data-stu-id="f8994-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="f8994-213">Wskazówki dotyczące kodu</span><span class="sxs-lookup"><span data-stu-id="f8994-213">Code Guidelines</span></span>

<span data-ttu-id="f8994-214">Podczas pisania kodu polecenia cmdlet należy przestrzegać następujących wytycznych.</span><span class="sxs-lookup"><span data-stu-id="f8994-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="f8994-215">Po znalezieniu wytycznych dotyczących kodu, które dotyczą danej sytuacji, należy zapoznać się z zaleceniami dotyczącymi projektowania, aby poznać podobne wskazówki.</span><span class="sxs-lookup"><span data-stu-id="f8994-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="f8994-216">Pochodne z klas poleceń cmdlet lub PSCmdlet (RC01)</span><span class="sxs-lookup"><span data-stu-id="f8994-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="f8994-217">Polecenie cmdlet musi pochodzić od klasy bazowej [System. Management. Automation. cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) lub [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) .</span><span class="sxs-lookup"><span data-stu-id="f8994-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="f8994-218">Polecenia cmdlet, które pochodzą z klasy [System. Management. Automation. cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) , nie są zależne od środowiska uruchomieniowego programu Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f8994-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="f8994-219">Można je wywołać bezpośrednio z dowolnego języka Microsoft .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f8994-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="f8994-220">Polecenia cmdlet, które pochodzą z klasy [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) , są zależne od środowiska uruchomieniowego programu Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f8994-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="f8994-221">W związku z tym są one wykonywane w obszarze działania.</span><span class="sxs-lookup"><span data-stu-id="f8994-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="f8994-222">Wszystkie klasy poleceń cmdlet, które są implementowane, muszą być klasami publicznymi.</span><span class="sxs-lookup"><span data-stu-id="f8994-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="f8994-223">Aby uzyskać więcej informacji na temat tych klas poleceń cmdlet, zobacz [polecenie cmdlet przegląd](./cmdlet-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="f8994-224">Określ atrybut cmdlet (RC02)</span><span class="sxs-lookup"><span data-stu-id="f8994-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="f8994-225">Aby można było rozpoznać polecenie cmdlet w programie Windows PowerShell, jego Klasa .NET Framework musi być uzupełniona atrybutem cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="f8994-226">Ten atrybut określa następujące funkcje polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="f8994-227">Para czasownik-i-rzeczownik, która identyfikuje polecenie cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="f8994-228">Domyślny zestaw parametrów, który jest używany, gdy określono wiele zestawów parametrów.</span><span class="sxs-lookup"><span data-stu-id="f8994-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="f8994-229">Domyślny zestaw parametrów jest używany, gdy program Windows PowerShell nie ma wystarczających informacji, aby określić, który parametr ma być używany.</span><span class="sxs-lookup"><span data-stu-id="f8994-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="f8994-230">Wskazuje, czy polecenie cmdlet obsługuje wywołania metody [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) .</span><span class="sxs-lookup"><span data-stu-id="f8994-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="f8994-231">Ta metoda wyświetla komunikat z potwierdzeniem, zanim polecenie cmdlet dokona zmiany w systemie.</span><span class="sxs-lookup"><span data-stu-id="f8994-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="f8994-232">Aby uzyskać więcej informacji na temat sposobu wykonywania żądań potwierdzenia, zobacz [żądanie potwierdzenia](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="f8994-233">Wskaż poziom wpływu (lub ważność) akcji skojarzonej z komunikatem potwierdzającym.</span><span class="sxs-lookup"><span data-stu-id="f8994-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="f8994-234">W większości przypadków należy użyć wartości domyślnej średniej.</span><span class="sxs-lookup"><span data-stu-id="f8994-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="f8994-235">Aby uzyskać więcej informacji o tym, jak poziom wpływu wpływa na żądania potwierdzenia, które są wyświetlane użytkownikowi, zobacz [żądanie potwierdzenia](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="f8994-236">Aby uzyskać więcej informacji na temat sposobu deklarowania atrybutu polecenia cmdlet, zobacz [polecenie cmdletattribute](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="f8994-237">Zastąp metodę przetwarzania danych wejściowych (RC03)</span><span class="sxs-lookup"><span data-stu-id="f8994-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="f8994-238">Aby polecenie cmdlet uczestniczyło w środowisku Windows PowerShell, należy zastąpić co najmniej jedną z następujących *metod przetwarzania danych wejściowych*.</span><span class="sxs-lookup"><span data-stu-id="f8994-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="f8994-239">[System. Management. Automation. cmdlet. BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) ta metoda jest wywoływana jednokrotnie i służy do udostępniania funkcji wstępnego przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="f8994-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="f8994-240">[System. Management. Automation. cmdlet. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) ta metoda jest wywoływana wiele razy i służy do udostępniania funkcji rejestrowania przez rekord.</span><span class="sxs-lookup"><span data-stu-id="f8994-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="f8994-241">[System. Management. Automation. cmdlet. EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) Metoda ta jest wywoływana jednokrotnie i służy do zapewnienia funkcji przetwarzania końcowego.</span><span class="sxs-lookup"><span data-stu-id="f8994-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="f8994-242">Określ atrybut OutputType (RC04)</span><span class="sxs-lookup"><span data-stu-id="f8994-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="f8994-243">Atrybut OutputType (wprowadzony w programie Windows PowerShell 2,0) określa typ .NET Framework, który powróci do potoku przez polecenie cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="f8994-244">Określając typ danych wyjściowych poleceń cmdlet, można łatwiej odnajdować obiekty zwracane przez polecenie cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="f8994-245">Aby uzyskać więcej informacji na temat dekorowania nazwy klasy poleceń cmdlet z tym atrybutem, zobacz [deklaracji atrybutu OutputType](./outputtype-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="f8994-246">Nie zachowuj dojść do obiektów wyjściowych (RC05)</span><span class="sxs-lookup"><span data-stu-id="f8994-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="f8994-247">Polecenie cmdlet nie powinno zachować żadnych dojść do obiektów, które są przesyłane do metody [System. Management. Automation. cmdlet. WriteObject \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="f8994-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="f8994-248">Te obiekty są przenoszone do następnego polecenia cmdlet w potoku lub są używane przez skrypt.</span><span class="sxs-lookup"><span data-stu-id="f8994-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="f8994-249">Jeśli zachowasz uchwyty do obiektów, dwie jednostki będą być właścicielami poszczególnych obiektów, co powoduje błędy.</span><span class="sxs-lookup"><span data-stu-id="f8994-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="f8994-250">Niezawodna obsługa błędów (RC06)</span><span class="sxs-lookup"><span data-stu-id="f8994-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="f8994-251">Środowisko administracyjne z własnej próby wykrywa i wprowadza ważne zmiany w systemie, który administrujesz.</span><span class="sxs-lookup"><span data-stu-id="f8994-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="f8994-252">W związku z tym ważne jest, aby polecenia cmdlet prawidłowo obsługiwały błędy.</span><span class="sxs-lookup"><span data-stu-id="f8994-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="f8994-253">Aby uzyskać więcej informacji na temat rekordów błędów, zobacz [raportowanie błędów programu Windows PowerShell](./error-reporting-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="f8994-254">Gdy błąd uniemożliwi przetworzenie kolejnych rekordów przez polecenie cmdlet, jest to błąd powodujący przerwanie.</span><span class="sxs-lookup"><span data-stu-id="f8994-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="f8994-255">Polecenie cmdlet musi wywołać metodę [System. Management. Automation. cmdlet. ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) , która odwołuje się do obiektu [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) .</span><span class="sxs-lookup"><span data-stu-id="f8994-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="f8994-256">Jeśli nie przechwycono wyjątku przez polecenie cmdlet, samo środowisko uruchomieniowe programu Windows PowerShell zgłasza błąd kończący, który zawiera mniej informacji.</span><span class="sxs-lookup"><span data-stu-id="f8994-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="f8994-257">W przypadku błędu niekończącego, który nie zatrzymuje operacji na następnym rekordzie, który pochodzi z potoku (na przykład rekordu utworzonego przez inny proces), polecenie cmdlet musi wywołać metodę [System. Management. Automation. cmdlet. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) , która odwołuje się do obiektu [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) .</span><span class="sxs-lookup"><span data-stu-id="f8994-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="f8994-258">Przykładem błędu niekończącego jest błąd występujący w przypadku niepowodzenia zatrzymania określonego procesu.</span><span class="sxs-lookup"><span data-stu-id="f8994-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="f8994-259">Wywołanie metody [System. Management. Automation. cmdlet. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) umożliwia użytkownikowi spójne wykonywanie żądanych akcji i przechowywanie informacji dla określonych akcji, które nie powiodły się.</span><span class="sxs-lookup"><span data-stu-id="f8994-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="f8994-260">Polecenie cmdlet powinno obsługiwać każdy rekord niezależnie od tego, jak to możliwe.</span><span class="sxs-lookup"><span data-stu-id="f8994-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="f8994-261">Obiekt [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) , do którego odwołuje się [System. Management. Automation. cmdlet. ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) i [System. Management. Automation. cmdlet. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) , wymaga elementu wyjątek w jego rdzeniu.</span><span class="sxs-lookup"><span data-stu-id="f8994-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="f8994-262">Postępuj zgodnie z .NET Framework wytycznych dotyczących projektowania podczas określania wyjątku do użycia.</span><span class="sxs-lookup"><span data-stu-id="f8994-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="f8994-263">Jeśli błąd jest semantycznie taki sam jak istniejący wyjątek, użyj tego wyjątku lub pochodzi z tego wyjątku.</span><span class="sxs-lookup"><span data-stu-id="f8994-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="f8994-264">W przeciwnym razie Utwórz nowy wyjątek lub hierarchię wyjątków bezpośrednio z typu [System. Exception](/dotnet/api/System.Exception) .</span><span class="sxs-lookup"><span data-stu-id="f8994-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="f8994-265">Obiekt [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) wymaga również kategorii błędów, która grupuje błędy użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f8994-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="f8994-266">Użytkownik może wyświetlić błędy w oparciu o kategorię, ustawiając wartość `$ErrorView` zmiennej Shell na CategoryView.</span><span class="sxs-lookup"><span data-stu-id="f8994-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="f8994-267">Możliwe kategorie są definiowane przez Wyliczenie [System. Management. Automation. ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) .</span><span class="sxs-lookup"><span data-stu-id="f8994-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="f8994-268">Jeśli polecenie cmdlet tworzy nowy wątek i jeśli kod, który jest uruchomiony w tym wątku zgłasza nieobsługiwany wyjątek, program Windows PowerShell nie przechwytuje tego błędu i zakończy proces.</span><span class="sxs-lookup"><span data-stu-id="f8994-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="f8994-269">Jeśli obiekt ma w swoim destruktorze kod, który powoduje nieobsługiwany wyjątek, program Windows PowerShell nie przechwytuje błędu i zakończy proces.</span><span class="sxs-lookup"><span data-stu-id="f8994-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="f8994-270">Występuje to również, gdy obiekt wywołuje metody Dispose, które powodują nieobsługiwany wyjątek.</span><span class="sxs-lookup"><span data-stu-id="f8994-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="f8994-271">Wdrażanie poleceń cmdlet przy użyciu modułu programu Windows PowerShell (RC07)</span><span class="sxs-lookup"><span data-stu-id="f8994-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="f8994-272">Utwórz moduł programu Windows PowerShell umożliwiający pakowanie i wdrażanie poleceń cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="f8994-273">Obsługa modułów jest wprowadzana w programie Windows PowerShell 2,0.</span><span class="sxs-lookup"><span data-stu-id="f8994-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="f8994-274">Zestawów zawierających klasy poleceń cmdlet można używać bezpośrednio jako plików modułów binarnych (jest to bardzo przydatne podczas testowania poleceń cmdlet) lub można utworzyć manifest modułu, który odwołuje się do zestawów poleceń cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f8994-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="f8994-275">(W przypadku korzystania z modułów można także dodać istniejące zestawy przystawek). Aby uzyskać więcej informacji o modułach, zobacz [pisanie modułu programu Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="f8994-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="f8994-276">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="f8994-276">See Also</span></span>

[<span data-ttu-id="f8994-277">Zdecydowanie zalecane wskazówki dotyczące programowania</span><span class="sxs-lookup"><span data-stu-id="f8994-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="f8994-278">Wytyczne dotyczące programowania</span><span class="sxs-lookup"><span data-stu-id="f8994-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="f8994-279">Pisanie polecenia cmdlet programu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f8994-279">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
