---
title: Tworzenie dostawcy kontenera Windows PowerShell | Dokumentacja firmy Microsoft
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: 9e7da13ff559e802d52df475f2a555baeeeef983
ms.sourcegitcommit: 01b81317029b28dd9b61d167045fd31f1ec7bc06
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/17/2019
ms.locfileid: "65855193"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="79086-102">Tworzenie dostawcy kontenerów programu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="79086-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="79086-103">W tym temacie opisano sposób tworzenia dostawcy środowiska Windows PowerShell, którego można używać w magazynach danych wielowarstwową.</span><span class="sxs-lookup"><span data-stu-id="79086-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="79086-104">Dla tego typu magazynu danych najwyższy poziom magazynu zawiera elementy katalogu głównego, a każdy kolejnych poziom jest określany jako węzeł elementów podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="79086-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="79086-105">Przez umożliwienie użytkownikowi pracować nad tych węzłów podrzędnych, użytkownik może wchodzić hierarchicznie przez Magazyn danych.</span><span class="sxs-lookup"><span data-stu-id="79086-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="79086-106">Dostawców, którzy mogą pracować na magazyny danych wielopoziomowe są określane jako dostawcy kontenera programu Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="79086-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="79086-107">Należy jednak pamiętać, że dostawcy kontenera programu Windows PowerShell, mogą być używane tylko wtedy, gdy jeden kontener (nie zagnieżdżone kontenery) przy użyciu elementów.</span><span class="sxs-lookup"><span data-stu-id="79086-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="79086-108">W przypadku zagnieżdżone kontenery należy zaimplementować dostawcę nawigacji programu Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="79086-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="79086-109">Aby uzyskać więcej informacji na temat implementowania dostawcy nawigacji programu Windows PowerShell, zobacz [tworzenia dostawcy usługi Windows PowerShell nawigacji](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="79086-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="79086-110">Możesz pobrać C# pliku źródłowego (AccessDBSampleProvider04.cs) dla tego dostawcy, za pomocą programu Microsoft Windows oprogramowania Development Kit dla Windows Vista i składników środowiska uruchomieniowego programu .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="79086-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="79086-111">Aby uzyskać instrukcje pobierania, zobacz [jak instalowanie programu Windows PowerShell i pobierania zestawu SDK programu Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="79086-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="79086-112">Pliki pobrane źródło są dostępne w  **\<przykłady programu PowerShell >** katalogu.</span><span class="sxs-lookup"><span data-stu-id="79086-112">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="79086-113">Aby uzyskać więcej informacji na temat innych implementacji dostawcy środowiska Windows PowerShell, zobacz [projektowania Your Windows PowerShell dostawcy](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="79086-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="79086-114">Dostawcy kontenera programu Windows PowerShell, które są opisane w tym miejscu definiuje bazy danych jako jej jeden kontener za pomocą tabel i wiersze obiektu bazy danych, zdefiniowane jako elementy kontenera.</span><span class="sxs-lookup"><span data-stu-id="79086-114">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="79086-115">Należy pamiętać, zakłada, że ten projekt bazy danych, które zawiera pole o identyfikatorze nazwa i typ pola to LongInteger.</span><span class="sxs-lookup"><span data-stu-id="79086-115">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="79086-116">Definiowanie klasy dostawcy kontenera Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="79086-116">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="79086-117">Dostawcy kontenera programu Windows PowerShell, należy zdefiniować klasę .NET, która pochodzi od klasy [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) klasy bazowej.</span><span class="sxs-lookup"><span data-stu-id="79086-117">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="79086-118">Poniżej przedstawiono w definicji klasy dla dostawcy kontenera programu Windows PowerShell, które są opisane w tej sekcji.</span><span class="sxs-lookup"><span data-stu-id="79086-118">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="79086-119">Należy zauważyć, że w tej definicji klasy [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atrybut zawiera dwa parametry.</span><span class="sxs-lookup"><span data-stu-id="79086-119">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="79086-120">Pierwszy parametr określa przyjazną dla użytkownika nazwę dostawcy, który jest używany przez program Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="79086-120">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="79086-121">Drugi parametr określa specyficzne możliwości programu Windows PowerShell, które dostawca udostępnia do środowiska wykonawczego programu Windows PowerShell podczas przetwarzania polecenia.</span><span class="sxs-lookup"><span data-stu-id="79086-121">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="79086-122">Dla tego dostawcy istnieją nie konkretne funkcje programu Windows PowerShell, które są dodawane.</span><span class="sxs-lookup"><span data-stu-id="79086-122">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="79086-123">Definiowanie podstawowe funkcje</span><span class="sxs-lookup"><span data-stu-id="79086-123">Defining Base Functionality</span></span>

<span data-ttu-id="79086-124">Zgodnie z opisem w [projektowania Your Windows PowerShell dostawcy](./designing-your-windows-powershell-provider.md), [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) klasa pochodzi od innych klas, które podano funkcje innego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="79086-124">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="79086-125">Dostawcy kontenera programu Windows PowerShell, w związku z tym, musi zdefiniować wszystkie funkcje udostępniane przez te klasy.</span><span class="sxs-lookup"><span data-stu-id="79086-125">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="79086-126">Aby zaimplementować funkcje dodawania informacji specyficznych dla sesji inicjowania i zwalniania zasobów, które są używane przez dostawcę, zobacz [tworzenia podstawowego dostawcy programu PowerShell Windows](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="79086-126">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="79086-127">Jednak większość dostawców (w tym dostawcy opisane w tym miejscu) można użyć Domyślna implementacja tej funkcji, które są dostarczane przez środowisko Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="79086-127">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="79086-128">Aby uzyskać dostęp do magazynu danych, dostawca musi implementować metody [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) klasy bazowej.</span><span class="sxs-lookup"><span data-stu-id="79086-128">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="79086-129">Aby uzyskać więcej informacji na temat implementowania tych metod, zobacz [Tworzenie dostawcy dysk programu Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="79086-129">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="79086-130">Do modyfikowania elementów magazynu danych, takich jak wprowadzenie, ustawienia i czyszczenie elementów, dostawca musi implementować metod dostarczonych przez [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) klasy bazowej.</span><span class="sxs-lookup"><span data-stu-id="79086-130">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="79086-131">Aby uzyskać więcej informacji na temat implementowania tych metod, zobacz [Tworzenie dostawcy usługi Windows PowerShell elementu](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="79086-131">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="79086-132">Trwa pobieranie elementów podrzędnych</span><span class="sxs-lookup"><span data-stu-id="79086-132">Retrieving Child Items</span></span>

<span data-ttu-id="79086-133">Aby pobrać element podrzędny, należy zastąpić dostawcy kontenera programu Windows PowerShell [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metody w celu obsługi wywołania z `Get-ChildItem` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-133">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="79086-134">Ta metoda umożliwia pobranie elementów podrzędnych z magazynu danych i zapisuje je do potoku jako obiekty.</span><span class="sxs-lookup"><span data-stu-id="79086-134">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="79086-135">Jeśli `recurse` parametru polecenia cmdlet jest określony, metoda pobiera wszystkie elementy podrzędne, niezależnie od tego, jaki poziom znajdują się w.</span><span class="sxs-lookup"><span data-stu-id="79086-135">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="79086-136">Jeśli `recurse` parametr nie zostanie określony, metoda pobiera tylko jeden poziom elementów podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="79086-136">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="79086-137">Oto implementacja [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metody dla tego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="79086-137">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="79086-138">Należy zauważyć, że ta metoda umożliwia pobranie podrzędnych elementów we wszystkich tabelach bazy danych po ścieżce wskazuje bazy danych programu Access, a następnie pobiera elementy podrzędne z wiersze tej tabeli, jeśli ścieżka wskazuje tabeli danych.</span><span class="sxs-lookup"><span data-stu-id="79086-138">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="79086-139">Warto zapamiętać o implementowaniu GetChildItems</span><span class="sxs-lookup"><span data-stu-id="79086-139">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="79086-140">Następujące warunki mogą dotyczyć implementacji [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="79086-140">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="79086-141">Podczas definiowania klasy dostawcy, dostawcy kontenera programu Windows PowerShell może deklarować możliwości dostawcy ExpandWildcards, filtr, Dołącz lub Wyklucz, z [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="79086-141">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="79086-142">W takich przypadkach wykonania [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metoda musi upewnij się, że ścieżka przekazywany do metody spełnia wymagania określonego możliwości.</span><span class="sxs-lookup"><span data-stu-id="79086-142">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="79086-143">Aby to zrobić, metoda powinien uzyskiwać dostęp do odpowiedniej właściwości, na przykład, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) i [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) właściwości.</span><span class="sxs-lookup"><span data-stu-id="79086-143">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="79086-144">Implementacja tej metody należy wziąć pod uwagę dowolnego rodzaju dostępu do elementu, że element jest widoczny dla użytkownika.</span><span class="sxs-lookup"><span data-stu-id="79086-144">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="79086-145">Na przykład, jeśli użytkownik ma dostęp do zapisu do pliku za pośrednictwem dostawcy systemu plików (dostarczonych przez program Windows PowerShell), ale nie dostęp do odczytu, plik nadal istnieje i [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) zwraca `true`.</span><span class="sxs-lookup"><span data-stu-id="79086-145">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="79086-146">Wdrożenie może wymagać sprawdzenia elementu nadrzędnego, dziecka mogą być wyliczane.</span><span class="sxs-lookup"><span data-stu-id="79086-146">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="79086-147">Podczas zapisywania wielu elementów [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metoda może zająć trochę czasu.</span><span class="sxs-lookup"><span data-stu-id="79086-147">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="79086-148">Można zaprojektować dostawcą, aby zapisać elementów za pomocą [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) metodą w danym momencie.</span><span class="sxs-lookup"><span data-stu-id="79086-148">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="79086-149">Przy użyciu tej metody spowoduje wyświetlenie elementów do użytkownika w strumieniu.</span><span class="sxs-lookup"><span data-stu-id="79086-149">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="79086-150">Implementacja [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) jest odpowiedzialny za przypadku łączy cyklicznych i podobnych, co uniemożliwia nieskończoną rekursję.</span><span class="sxs-lookup"><span data-stu-id="79086-150">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="79086-151">Odpowiednie kończący należy zgłosić wyjątek do uwzględnienia tych warunków.</span><span class="sxs-lookup"><span data-stu-id="79086-151">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="79086-152">Dołączanie parametrów dynamicznych do polecenia cmdlet Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="79086-152">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="79086-153">Czasami `Get-ChildItem` polecenia cmdlet, który wywołuje [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) wymaga dodatkowych parametrów, które są określone dynamicznie w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="79086-153">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="79086-154">Aby zapewnić te parametry dynamiczne, należy zaimplementować dostawcy kontenera programu Windows PowerShell [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) metody.</span><span class="sxs-lookup"><span data-stu-id="79086-154">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="79086-155">Ta metoda pobiera parametry dynamiczne dla elementu w ścieżce wskazany i zwraca obiekt zawierający właściwości i pola za pomocą analizy atrybuty podobna do klasy polecenia cmdlet lub [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) obiektu.</span><span class="sxs-lookup"><span data-stu-id="79086-155">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="79086-156">Środowisko wykonawcze programu Windows PowerShell korzysta zwrócony obiekt można dodać parametry do `Get-ChildItem` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-156">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="79086-157">Ten dostawca kontenera programu Windows PowerShell nie implementuje tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-157">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="79086-158">Jednakże poniższy kod jest domyślna implementacja tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-158">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="79086-159">Podczas pobierania nazw elementów podrzędnych</span><span class="sxs-lookup"><span data-stu-id="79086-159">Retrieving Child Item Names</span></span>

<span data-ttu-id="79086-160">Aby pobrać nazwy elementów podrzędnych, należy zastąpić dostawcy kontenera programu Windows PowerShell [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) metody w celu obsługi wywołania z `Get-ChildItem`polecenia cmdlet podczas jego `Name` określono parametr.</span><span class="sxs-lookup"><span data-stu-id="79086-160">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="79086-161">Ta metoda umożliwia pobranie nazwy elementów podrzędnych dla określonej nazwy elementu ścieżkę lub podrzędny wszystkich kontenerów, jeśli `returnAllContainers` określono parametr polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-161">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="79086-162">Nazwa podrzędnej jest częścią liścia ścieżki.</span><span class="sxs-lookup"><span data-stu-id="79086-162">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="79086-163">Na przykład nazwę podrzędnej c:\windows\system32\abc.dll ścieżki to "abc.dll".</span><span class="sxs-lookup"><span data-stu-id="79086-163">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="79086-164">Nazwa podrzędnej c:\windows\system32 katalogu jest "system32".</span><span class="sxs-lookup"><span data-stu-id="79086-164">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="79086-165">Oto implementacja [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) metody dla tego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="79086-165">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="79086-166">Należy zauważyć, że metoda pobiera nazwy tabel, jeśli określona ścieżka wskazuje bazy danych programu Access (dysku) i numery wierszy, jeśli ścieżka wskazuje tabelę.</span><span class="sxs-lookup"><span data-stu-id="79086-166">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="79086-167">Warto zapamiętać o implementowaniu GetChildNames</span><span class="sxs-lookup"><span data-stu-id="79086-167">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="79086-168">Następujące warunki mogą dotyczyć implementacji [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="79086-168">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="79086-169">Podczas definiowania klasy dostawcy, dostawcy kontenera programu Windows PowerShell może deklarować możliwości dostawcy ExpandWildcards, filtr, Dołącz lub Wyklucz, z [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="79086-169">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="79086-170">W takich przypadkach wykonania [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metoda musi upewnij się, że ścieżka przekazywany do metody spełnia wymagania określonego możliwości.</span><span class="sxs-lookup"><span data-stu-id="79086-170">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="79086-171">Aby to zrobić, metoda powinien uzyskiwać dostęp do odpowiedniej właściwości, na przykład, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) i [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) właściwości.</span><span class="sxs-lookup"><span data-stu-id="79086-171">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="79086-172">Wyjątkiem od tej reguły występuje, gdy `returnAllContainers` określono parametr polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-172">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="79086-173">W tym przypadku metoda Pobierz dowolną nazwę podrzędnych dla kontenera, nawet jeśli nie odpowiada wartości [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), lub [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) właściwości.</span><span class="sxs-lookup"><span data-stu-id="79086-173">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="79086-174">Domyślnie przesłonięcia tej metody nie powinna pobrać nazwy obiektów, które zazwyczaj są ukryte przed użytkownikiem, chyba że [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) określono właściwości.</span><span class="sxs-lookup"><span data-stu-id="79086-174">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="79086-175">Jeśli określona ścieżka wskazuje kontener [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) właściwość nie jest wymagane.</span><span class="sxs-lookup"><span data-stu-id="79086-175">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="79086-176">Implementacja [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) jest odpowiedzialny za przypadku łączy cyklicznych i podobnych, co uniemożliwia nieskończoną rekursję.</span><span class="sxs-lookup"><span data-stu-id="79086-176">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="79086-177">Odpowiednie kończący należy zgłosić wyjątek do uwzględnienia tych warunków.</span><span class="sxs-lookup"><span data-stu-id="79086-177">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="79086-178">Dołączanie parametrów dynamicznych do polecenia cmdlet Get-ChildItem (nazwa)</span><span class="sxs-lookup"><span data-stu-id="79086-178">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="79086-179">Czasami `Get-ChildItem` polecenia cmdlet (przy użyciu `Name` parametr) wymaga dodatkowych parametrów, które są określone dynamicznie w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="79086-179">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="79086-180">Aby zapewnić te parametry dynamiczne, należy zaimplementować dostawcy kontenera programu Windows PowerShell [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) metody.</span><span class="sxs-lookup"><span data-stu-id="79086-180">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="79086-181">Ta metoda pobiera parametry dynamiczne dla elementu w ścieżce wskazany i zwraca obiekt zawierający właściwości i pola za pomocą analizy atrybuty podobna do klasy polecenia cmdlet lub [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) obiektu.</span><span class="sxs-lookup"><span data-stu-id="79086-181">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="79086-182">Środowisko wykonawcze programu Windows PowerShell korzysta zwrócony obiekt można dodać parametry do `Get-ChildItem` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-182">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="79086-183">Ten dostawca nie implementuje tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-183">This provider does not implement this method.</span></span> <span data-ttu-id="79086-184">Jednakże poniższy kod jest domyślna implementacja tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-184">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="79086-185">Zmienianie nazw elementów</span><span class="sxs-lookup"><span data-stu-id="79086-185">Renaming Items</span></span>

<span data-ttu-id="79086-186">Aby zmienić nazwę elementu, należy zastąpić dostawcy kontenera programu Windows PowerShell [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metody w celu obsługi wywołania z `Rename-Item` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-186">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="79086-187">Ta metoda zmiany nazwy elementu w określonej ścieżce na nową nazwę, pod warunkiem.</span><span class="sxs-lookup"><span data-stu-id="79086-187">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="79086-188">Nowa nazwa musi być zawsze względem elementu nadrzędnego (kontenera).</span><span class="sxs-lookup"><span data-stu-id="79086-188">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="79086-189">Ten dostawca nie zastępuje [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metody.</span><span class="sxs-lookup"><span data-stu-id="79086-189">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="79086-190">Jednakże Oto domyślną implementację.</span><span class="sxs-lookup"><span data-stu-id="79086-190">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="79086-191">Warto zapamiętać o implementowaniu RenameItem</span><span class="sxs-lookup"><span data-stu-id="79086-191">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="79086-192">Następujące warunki mogą dotyczyć implementacji [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="79086-192">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="79086-193">Podczas definiowania klasy dostawcy, dostawcy kontenera programu Windows PowerShell może deklarować możliwości dostawcy ExpandWildcards, filtr, Dołącz lub Wyklucz, z [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="79086-193">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="79086-194">W takich przypadkach wykonania [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metoda musi upewnij się, że ścieżka przekazywany do metody spełnia wymagania określonego możliwości.</span><span class="sxs-lookup"><span data-stu-id="79086-194">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="79086-195">Aby to zrobić, metoda powinien uzyskiwać dostęp do odpowiedniej właściwości, na przykład, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) i [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) właściwości.</span><span class="sxs-lookup"><span data-stu-id="79086-195">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="79086-196">[System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metoda jest przeznaczona do zmiany nazwy elementu tylko, a nie operacji przenoszenia.</span><span class="sxs-lookup"><span data-stu-id="79086-196">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="79086-197">Implementacja metody powinien zapisać błąd, jeśli `newName` parametr zawiera separatorami ścieżki lub w przeciwnym razie może spowodować element, aby zmienić jego lokalizacji nadrzędnej.</span><span class="sxs-lookup"><span data-stu-id="79086-197">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="79086-198">Domyślnie przesłonięcia tej metody powinna nie zmianę nazw obiektów chyba że [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) określono właściwości.</span><span class="sxs-lookup"><span data-stu-id="79086-198">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="79086-199">Jeśli określona ścieżka wskazuje kontener [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) właściwość nie jest wymagane.</span><span class="sxs-lookup"><span data-stu-id="79086-199">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="79086-200">Implementacja [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) powinny wywoływać metodę [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) i sprawdź wartość zwracaną przed wprowadzeniem jakichkolwiek zmian w magazynie danych.</span><span class="sxs-lookup"><span data-stu-id="79086-200">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="79086-201">Ta metoda jest używana, aby potwierdzić wykonanie operacji, podczas wprowadzania zmian do stanu systemu, na przykład zmiana nazw plików.</span><span class="sxs-lookup"><span data-stu-id="79086-201">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="79086-202">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) wysyła nazwę zasobu był zmieniany na użytkownika, ze środowiskiem uruchomieniowym programu Windows PowerShell, biorąc pod uwagę wszystkie ustawienia wiersza polecenia lub zmienne preferencji w Określanie, co powinno być wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="79086-202">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="79086-203">Po wywołaniu [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) zwraca `true`, [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) powinny wywoływać metodę [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metody.</span><span class="sxs-lookup"><span data-stu-id="79086-203">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="79086-204">Ta metoda wysyła komunikat potwierdzenia dla użytkownika, aby zezwolić na dodatkową opinię powiedzieć, jeśli operacja powinna być kontynuowana.</span><span class="sxs-lookup"><span data-stu-id="79086-204">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="79086-205">Dostawca powinien wywoływać [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) jako dodatkowe sprawdzenie modyfikacji potencjalnie niebezpiecznych systemu.</span><span class="sxs-lookup"><span data-stu-id="79086-205">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="79086-206">Dołączanie parametrów dynamicznych do polecenia cmdlet Zmień nazwę elementu</span><span class="sxs-lookup"><span data-stu-id="79086-206">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="79086-207">Czasami `Rename-Item` polecenie cmdlet wymaga dodatkowych parametrów, które są określone dynamicznie w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="79086-207">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="79086-208">Aby zapewnić te parametry dynamiczne, programu Windows PowerShell kontenera dostawca musi implementować [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) metody.</span><span class="sxs-lookup"><span data-stu-id="79086-208">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="79086-209">Ta metoda pobiera parametry dla elementu w ścieżce wskazany i zwraca obiekt zawierający właściwości i pola za pomocą analizy atrybuty podobna do klasy polecenia cmdlet lub [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) obiektu.</span><span class="sxs-lookup"><span data-stu-id="79086-209">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="79086-210">Środowisko wykonawcze programu Windows PowerShell korzysta zwrócony obiekt można dodać parametry do `Rename-Item` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-210">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="79086-211">Ten dostawca kontenera nie implementuje tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-211">This container provider does not implement this method.</span></span> <span data-ttu-id="79086-212">Jednakże poniższy kod jest domyślna implementacja tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-212">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="79086-213">Tworzenie nowych elementów</span><span class="sxs-lookup"><span data-stu-id="79086-213">Creating New Items</span></span>

<span data-ttu-id="79086-214">Aby utworzyć nowe elementy, należy zaimplementować dostawcy kontenera [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metody w celu obsługi wywołania z `New-Item` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-214">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="79086-215">Ta metoda tworzy element danych znajdujących się w określonej ścieżce.</span><span class="sxs-lookup"><span data-stu-id="79086-215">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="79086-216">`type` Parametru polecenia cmdlet zawiera typ zdefiniowany przez dostawcę dla nowego elementu.</span><span class="sxs-lookup"><span data-stu-id="79086-216">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="79086-217">Na przykład używa dostawcy FileSystem `type` parametru o wartości "file" lub "directory".</span><span class="sxs-lookup"><span data-stu-id="79086-217">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="79086-218">`newItemValue` Parametru polecenia cmdlet określa wartość specyficzne dla dostawcy dla nowego elementu.</span><span class="sxs-lookup"><span data-stu-id="79086-218">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="79086-219">Oto implementacja [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metody dla tego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="79086-219">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="79086-220">Warto zapamiętać o implementowaniu NewItem</span><span class="sxs-lookup"><span data-stu-id="79086-220">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="79086-221">Następujące warunki mogą dotyczyć implementacji [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="79086-221">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="79086-222">[System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoda powinna dokonać porównania bez uwzględniania wielkości przekazany ciąg `type` parametru.</span><span class="sxs-lookup"><span data-stu-id="79086-222">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="79086-223">Powinien także zezwalać na co najmniej niejednoznaczne dopasowania.</span><span class="sxs-lookup"><span data-stu-id="79086-223">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="79086-224">Na przykład dla typów "file" i "directory", tylko pierwsza litera jest wymagany do odróżniania.</span><span class="sxs-lookup"><span data-stu-id="79086-224">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="79086-225">Jeśli `type` parametr wskazuje typ dostawcy nie można utworzyć, [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoda powinien zapisać ArgumentException komunikatem wskazujący typy można utworzyć dostawcy.</span><span class="sxs-lookup"><span data-stu-id="79086-225">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="79086-226">Aby uzyskać `newItemValue` parametr, wdrażanie [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoda jest zalecana do akceptowania ciągów co najmniej.</span><span class="sxs-lookup"><span data-stu-id="79086-226">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="79086-227">Typ obiektu, który jest pobierany przez powinien również akceptować [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) metodę dla tej samej ścieżce.</span><span class="sxs-lookup"><span data-stu-id="79086-227">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="79086-228">[System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoda może używać [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) metodę, aby przekonwertować typy do żądany typ.</span><span class="sxs-lookup"><span data-stu-id="79086-228">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="79086-229">Implementacja [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) powinny wywoływać metodę [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) i sprawdź wartość zwracaną przed wprowadzeniem jakichkolwiek zmian w magazynie danych.</span><span class="sxs-lookup"><span data-stu-id="79086-229">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="79086-230">Po wywołaniu [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) zwraca wartość true, [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) Metoda powinna wywoływać [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metodę jako dodatkowe sprawdzenie modyfikacji potencjalnie niebezpiecznych systemu.</span><span class="sxs-lookup"><span data-stu-id="79086-230">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="79086-231">Dołączanie parametrów dynamicznych do polecenia cmdlet nowy element</span><span class="sxs-lookup"><span data-stu-id="79086-231">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="79086-232">Czasami `New-Item` polecenie cmdlet wymaga dodatkowych parametrów, które są określone dynamicznie w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="79086-232">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="79086-233">Aby zapewnić te parametry dynamiczne, dostawca kontenera musi implementować [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) metody.</span><span class="sxs-lookup"><span data-stu-id="79086-233">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="79086-234">Ta metoda pobiera parametry dla elementu w ścieżce wskazany i zwraca obiekt zawierający właściwości i pola za pomocą analizy atrybuty podobna do klasy polecenia cmdlet lub [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) obiektu.</span><span class="sxs-lookup"><span data-stu-id="79086-234">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="79086-235">Środowisko wykonawcze programu Windows PowerShell korzysta zwrócony obiekt można dodać parametry do `New-Item` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-235">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="79086-236">Ten dostawca nie implementuje tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-236">This provider does not implement this method.</span></span> <span data-ttu-id="79086-237">Jednakże poniższy kod jest domyślna implementacja tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-237">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="79086-238">Usuwanie elementów</span><span class="sxs-lookup"><span data-stu-id="79086-238">Removing Items</span></span>

<span data-ttu-id="79086-239">Aby usunąć elementy, należy zastąpić dostawcy programu Windows PowerShell [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) metody w celu obsługi wywołania z `Remove-Item` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-239">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="79086-240">Ta metoda usuwa element z magazynu danych w określonej ścieżce.</span><span class="sxs-lookup"><span data-stu-id="79086-240">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="79086-241">Jeśli `recurse` parametru `Remove-Item` polecenia cmdlet jest ustawiona na `true`, metoda usuwa wszystkie elementy podrzędne, niezależnie od ich poziomu.</span><span class="sxs-lookup"><span data-stu-id="79086-241">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="79086-242">Jeśli parametr jest ustawiony na `false`, metoda usuwa tylko jeden element w określonej ścieżce.</span><span class="sxs-lookup"><span data-stu-id="79086-242">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="79086-243">Ten dostawca nie obsługuje usuwania elementu.</span><span class="sxs-lookup"><span data-stu-id="79086-243">This provider does not support item removal.</span></span> <span data-ttu-id="79086-244">Jednakże, poniższy kod jest domyślna Implementacja klasy [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="79086-244">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="79086-245">Warto zapamiętać o implementowaniu RemoveItem</span><span class="sxs-lookup"><span data-stu-id="79086-245">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="79086-246">Następujące warunki mogą dotyczyć implementacji [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="79086-246">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="79086-247">Podczas definiowania klasy dostawcy, dostawcy kontenera programu Windows PowerShell może deklarować możliwości dostawcy ExpandWildcards, filtr, Dołącz lub Wyklucz, z [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="79086-247">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="79086-248">W takich przypadkach wykonania [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metoda musi upewnij się, że ścieżka przekazywany do metody spełnia wymagania określonego możliwości.</span><span class="sxs-lookup"><span data-stu-id="79086-248">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="79086-249">Aby to zrobić, metoda powinien uzyskiwać dostęp do odpowiedniej właściwości, na przykład, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) i [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) właściwości.</span><span class="sxs-lookup"><span data-stu-id="79086-249">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="79086-250">Domyślnie przesłonięcia tej metody nie należy usuwać obiektów chyba że [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) właściwość jest ustawiona na wartość true.</span><span class="sxs-lookup"><span data-stu-id="79086-250">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="79086-251">Jeśli określona ścieżka wskazuje kontener [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) właściwość nie jest wymagane.</span><span class="sxs-lookup"><span data-stu-id="79086-251">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="79086-252">Implementacja [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) jest odpowiedzialny za przypadku łączy cyklicznych i podobnych, co uniemożliwia nieskończoną rekursję.</span><span class="sxs-lookup"><span data-stu-id="79086-252">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="79086-253">Odpowiednie kończący należy zgłosić wyjątek do uwzględnienia tych warunków.</span><span class="sxs-lookup"><span data-stu-id="79086-253">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="79086-254">Implementacja [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) powinny wywoływać metodę [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) i sprawdź wartość zwracaną przed wprowadzeniem jakichkolwiek zmian w magazynie danych.</span><span class="sxs-lookup"><span data-stu-id="79086-254">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="79086-255">Po wywołaniu [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) zwraca `true`, [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) powinny wywoływać metodę [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metodę jako dodatkowe sprawdzenie modyfikacji potencjalnie niebezpiecznych systemu.</span><span class="sxs-lookup"><span data-stu-id="79086-255">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="79086-256">Dołączanie parametrów dynamicznych do polecenia cmdlet Remove element</span><span class="sxs-lookup"><span data-stu-id="79086-256">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="79086-257">Czasami `Remove-Item` polecenie cmdlet wymaga dodatkowych parametrów, które są określone dynamicznie w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="79086-257">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="79086-258">Aby zapewnić te parametry dynamiczne, dostawca kontenera musi implementować [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) metodę, aby obsługiwać te parametry.</span><span class="sxs-lookup"><span data-stu-id="79086-258">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="79086-259">Ta metoda pobiera parametry dynamiczne dla elementu w ścieżce wskazany i zwraca obiekt zawierający właściwości i pola za pomocą analizy atrybuty podobna do klasy polecenia cmdlet lub [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) obiektu.</span><span class="sxs-lookup"><span data-stu-id="79086-259">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="79086-260">Środowisko wykonawcze programu Windows PowerShell korzysta zwrócony obiekt można dodać parametry do `Remove-Item` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-260">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="79086-261">Ten dostawca kontenera nie implementuje tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-261">This container provider does not implement this method.</span></span> <span data-ttu-id="79086-262">Jednakże, poniższy kod jest domyślna Implementacja klasy [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="79086-262">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="79086-263">Wykonywanie zapytań dotyczących elementów podrzędnych</span><span class="sxs-lookup"><span data-stu-id="79086-263">Querying for Child Items</span></span>

<span data-ttu-id="79086-264">Aby sprawdzić, czy elementy podrzędne istnieją w określonej ścieżce, musisz przesłonić dostawcy kontenera programu Windows PowerShell [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) metody.</span><span class="sxs-lookup"><span data-stu-id="79086-264">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="79086-265">Ta metoda zwraca `true` Jeśli element ma elementy podrzędne, a `false` inaczej.</span><span class="sxs-lookup"><span data-stu-id="79086-265">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="79086-266">Dla ścieżki o wartości null ani być pusta, metoda uwzględnia wszystkie elementy w magazynie danych jako elementy podrzędne i zwraca `true`.</span><span class="sxs-lookup"><span data-stu-id="79086-266">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="79086-267">Poniżej przedstawiono zastąpienie dla [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) metody.</span><span class="sxs-lookup"><span data-stu-id="79086-267">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="79086-268">Jeśli istnieje więcej niż dwóch części ścieżki tworzone przez metodę pomocnika ChunkPath, metoda zwraca `false`, ponieważ tylko kontenerach bazy danych i tabeli są zdefiniowane.</span><span class="sxs-lookup"><span data-stu-id="79086-268">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="79086-269">Aby uzyskać więcej informacji na temat tej metody pomocnika, zobacz metodę ChunkPath została omówiona w [tworzenia dostawcy usługi Windows PowerShell elementu](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="79086-269">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="79086-270">Warto zapamiętać o implementowaniu HasChildItems</span><span class="sxs-lookup"><span data-stu-id="79086-270">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="79086-271">Następujące warunki mogą dotyczyć implementacji [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="79086-271">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="79086-272">Jeśli dostawcy kontenera udostępnia głównego, zawierający interesujących punktów instalacji, implementacja [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) metoda powinna zwrócić `true`po o wartości null lub pusty ciąg jest przekazywana do ścieżki.</span><span class="sxs-lookup"><span data-stu-id="79086-272">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="79086-273">Kopiowanie elementów</span><span class="sxs-lookup"><span data-stu-id="79086-273">Copying Items</span></span>

<span data-ttu-id="79086-274">Aby skopiować elementy, należy zaimplementować dostawcy kontenera [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) metody w celu obsługi wywołania z `Copy-Item` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-274">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="79086-275">Ta metoda kopiuje element danych z lokalizacji wskazanej przez `path` parametru polecenia cmdlet do lokalizacji wskazanej przez `copyPath` parametru.</span><span class="sxs-lookup"><span data-stu-id="79086-275">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="79086-276">Jeśli `recurse` parametr jest określony, metoda kopiuje wszystkich kontenerów podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="79086-276">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="79086-277">Jeśli nie określono parametrów, metody Kopiuje jeden poziom elementów.</span><span class="sxs-lookup"><span data-stu-id="79086-277">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="79086-278">Ten dostawca nie implementuje tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-278">This provider does not implement this method.</span></span> <span data-ttu-id="79086-279">Jednakże, poniższy kod jest domyślna Implementacja klasy [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="79086-279">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="79086-280">Warto zapamiętać o implementowaniu CopyItem</span><span class="sxs-lookup"><span data-stu-id="79086-280">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="79086-281">Następujące warunki mogą dotyczyć implementacji [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="79086-281">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="79086-282">Podczas definiowania klasy dostawcy, dostawcy kontenera programu Windows PowerShell może deklarować możliwości dostawcy ExpandWildcards, filtr, Dołącz lub Wyklucz, z [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="79086-282">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="79086-283">W takich przypadkach wykonania [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metoda musi upewnij się, że ścieżka przekazywany do metody spełnia wymagania określonego możliwości.</span><span class="sxs-lookup"><span data-stu-id="79086-283">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="79086-284">Aby to zrobić, metoda powinien uzyskiwać dostęp do odpowiedniej właściwości, na przykład, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) i [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) właściwości.</span><span class="sxs-lookup"><span data-stu-id="79086-284">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="79086-285">Domyślnie przesłonięcia tej metody nie należy kopiować obiekty za pośrednictwem istniejących obiektów chyba że [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) właściwość jest ustawiona na `true`.</span><span class="sxs-lookup"><span data-stu-id="79086-285">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="79086-286">Na przykład dostawcy FileSystem nie skopiuje c:\temp\abc.txt przez istniejący plik c:\abc.txt chyba że [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) właściwość jest ustawiona na `true`.</span><span class="sxs-lookup"><span data-stu-id="79086-286">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="79086-287">Jeśli ścieżka określona w `copyPath` parametru istnieje i wskazuje kontener [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) właściwość nie jest wymagane.</span><span class="sxs-lookup"><span data-stu-id="79086-287">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="79086-288">W tym przypadku [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) należy skopiować element wskazywany przez `path` parametru do kontenera wskazywanym przez `copyPath` parametr jako element podrzędny.</span><span class="sxs-lookup"><span data-stu-id="79086-288">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="79086-289">Implementacja [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) jest odpowiedzialny za przypadku łączy cyklicznych i podobnych, co uniemożliwia nieskończoną rekursję.</span><span class="sxs-lookup"><span data-stu-id="79086-289">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="79086-290">Odpowiednie kończący należy zgłosić wyjątek do uwzględnienia tych warunków.</span><span class="sxs-lookup"><span data-stu-id="79086-290">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="79086-291">Implementacja [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) powinny wywoływać metodę [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) i sprawdź wartość zwracaną przed wprowadzeniem jakichkolwiek zmian w magazynie danych.</span><span class="sxs-lookup"><span data-stu-id="79086-291">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="79086-292">Po wywołaniu [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) zwraca wartość true, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) Metoda powinna wywoływać [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metodę jako dodatkowe sprawdzenie modyfikacji potencjalnie niebezpiecznych systemu.</span><span class="sxs-lookup"><span data-stu-id="79086-292">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="79086-293">Aby uzyskać więcej informacji na temat wywoływanie tych metod, zobacz [zmiany nazwy elementów](#renaming-items).</span><span class="sxs-lookup"><span data-stu-id="79086-293">For more information about calling these methods, see [Rename Items](#renaming-items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="79086-294">Dołączanie parametrów dynamicznych do polecenia cmdlet Copy-Item</span><span class="sxs-lookup"><span data-stu-id="79086-294">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="79086-295">Czasami `Copy-Item` polecenie cmdlet wymaga dodatkowych parametrów, które są określone dynamicznie w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="79086-295">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="79086-296">Aby zapewnić te parametry dynamiczne, należy zaimplementować dostawcy kontenera programu Windows PowerShell [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) metody, aby obsłużyć te Parametry.</span><span class="sxs-lookup"><span data-stu-id="79086-296">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="79086-297">Ta metoda pobiera parametry dla elementu w ścieżce wskazany i zwraca obiekt zawierający właściwości i pola za pomocą analizy atrybuty podobna do klasy polecenia cmdlet lub [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) obiektu.</span><span class="sxs-lookup"><span data-stu-id="79086-297">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="79086-298">Środowisko wykonawcze programu Windows PowerShell korzysta zwrócony obiekt można dodać parametry do `Copy-Item` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="79086-298">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="79086-299">Ten dostawca nie implementuje tej metody.</span><span class="sxs-lookup"><span data-stu-id="79086-299">This provider does not implement this method.</span></span> <span data-ttu-id="79086-300">Jednakże, poniższy kod jest domyślna Implementacja klasy [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="79086-300">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="79086-301">Przykładowy kod</span><span class="sxs-lookup"><span data-stu-id="79086-301">Code Sample</span></span>

<span data-ttu-id="79086-302">Aby uzyskać kompletny przykładowy kod, zobacz [przykładowy kod AccessDbProviderSample04](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="79086-302">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="79086-303">Tworzenie dostawcy programu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="79086-303">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="79086-304">Zobacz [sposobu rejestrowania poleceń cmdlet, dostawców i hostowanie aplikacji](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="79086-304">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="79086-305">Testowanie dostawcy programu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="79086-305">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="79086-306">Jeśli Twój dostawca programu Windows PowerShell został zarejestrowany za pomocą programu Windows PowerShell, można ją przetestować, uruchamiając obsługiwanych poleceń cmdlet w wierszu polecenia.</span><span class="sxs-lookup"><span data-stu-id="79086-306">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="79086-307">Należy pamiętać, że następujące przykładowe dane wyjściowe korzysta z fikcyjnych dostępu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="79086-307">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="79086-308">Uruchom `Get-ChildItem` polecenie cmdlet do pobierania listy elementów podrzędnych z tabeli Klienci w bazie danych programu Access.</span><span class="sxs-lookup"><span data-stu-id="79086-308">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="79086-309">Zostanie wyświetlone następujące dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="79086-309">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="79086-310">Uruchom `Get-ChildItem` polecenie cmdlet ponownie, aby pobrać dane z tabeli.</span><span class="sxs-lookup"><span data-stu-id="79086-310">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="79086-311">Zostanie wyświetlone następujące dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="79086-311">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="79086-312">Teraz za pomocą `Get-Item` polecenie cmdlet do pobierania elementów w wierszu 0 w tabeli danych.</span><span class="sxs-lookup"><span data-stu-id="79086-312">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="79086-313">Zostanie wyświetlone następujące dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="79086-313">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="79086-314">Ponowne użycie `Get-Item` można pobrać danych dla elementów w wierszu 0.</span><span class="sxs-lookup"><span data-stu-id="79086-314">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="79086-315">Zostanie wyświetlone następujące dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="79086-315">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="79086-316">Teraz za pomocą `New-Item` polecenia cmdlet, aby dodać wiersz do istniejącej tabeli.</span><span class="sxs-lookup"><span data-stu-id="79086-316">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="79086-317">`Path` Parametr określa pełną ścieżkę do wiersza i musi wskazywać, numer wiersza jest większa niż liczba istniejących wierszy w tabeli.</span><span class="sxs-lookup"><span data-stu-id="79086-317">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="79086-318">`Type` Parametr wskazuje "wiersz", aby określić typu elementu Dodawanie.</span><span class="sxs-lookup"><span data-stu-id="79086-318">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="79086-319">Na koniec `Value` parametr określa rozdzielana przecinkami lista wartości kolumn dla wiersza.</span><span class="sxs-lookup"><span data-stu-id="79086-319">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="79086-320">Sprawdź poprawność nowej operacji elementu w następujący sposób.</span><span class="sxs-lookup"><span data-stu-id="79086-320">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="79086-321">Zostanie wyświetlone następujące dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="79086-321">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="79086-322">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="79086-322">See Also</span></span>

[<span data-ttu-id="79086-323">Tworzenie programu Windows PowerShell dostawców</span><span class="sxs-lookup"><span data-stu-id="79086-323">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="79086-324">Projektowanie dostawcą Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="79086-324">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="79086-325">Implementowanie dostawcy elementu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="79086-325">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="79086-326">Implementowanie dostawcy nawigacji Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="79086-326">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="79086-327">Jak zarejestrować poleceń cmdlet, dostawców i aplikacji hosta</span><span class="sxs-lookup"><span data-stu-id="79086-327">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="79086-328">Zestaw SDK programu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="79086-328">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="79086-329">Windows PowerShell przewodnik</span><span class="sxs-lookup"><span data-stu-id="79086-329">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)