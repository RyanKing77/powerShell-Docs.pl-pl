---
ms.date: 06/05/2017
keywords: polecenia cmdlet programu PowerShell
title: Uruchamianie aparatu programu Windows PowerShell 2.0
ms.assetid: edafc2fa-7576-49c2-bbba-9336f4bcfc28
ms.openlocfilehash: f5dd01cd93095fe15cc7e57f97f4b2920e580c22
ms.sourcegitcommit: 00ff76d7d9414fe585c04740b739b9cf14d711e1
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/14/2018
ms.locfileid: "53405294"
---
# <a name="starting-the-windows-powershell-20-engine"></a><span data-ttu-id="3f19b-103">Uruchamianie aparatu programu Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="3f19b-103">Starting the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="3f19b-104">W tej sekcji wyjaśniono, jak można uruchomić aparatu programu Windows PowerShell 2.0 na Windows 8.1, Windows Server 2012 R2, Windows 8 i Windows Server 2012, obejmujących aparatu programu Windows PowerShell 2.0, a w innych systemach, na które Windows PowerShell 2.0, programu Windows PowerShell 3.0 i 4.0 programu PowerShell Windows są zainstalowane.</span><span class="sxs-lookup"><span data-stu-id="3f19b-104">This section explains how to start the Windows PowerShell 2.0 Engine on Windows 8.1, Windows Server 2012 R2, Windows 8, and Windows Server 2012, which include the Windows PowerShell 2.0 Engine, and on other systems on which Windows PowerShell 2.0, Windows PowerShell 3.0, and Windows PowerShell 4.0 are installed.</span></span>

<span data-ttu-id="3f19b-105">Windows PowerShell 4.0 i programu Windows PowerShell 3.0 są przeznaczone do zgodne ze starszymi wersjami za pomocą programu Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="3f19b-105">Windows PowerShell 4.0 and Windows PowerShell 3.0 are designed to be backwards compatible with Windows PowerShell 2.0.</span></span> <span data-ttu-id="3f19b-106">Polecenia cmdlet, dostawców, przystawki, moduły i skrypty napisana dla programu Windows PowerShell 2.0 uruchamiane bez zmian w programie Windows PowerShell 4.0 i programu Windows PowerShell 3.0.</span><span class="sxs-lookup"><span data-stu-id="3f19b-106">Cmdlets, providers, snap-ins, modules, and scripts written for Windows PowerShell 2.0 run unchanged in Windows PowerShell 4.0 and Windows PowerShell 3.0.</span></span> <span data-ttu-id="3f19b-107">Jednak ze względu na zmiany w zasadach aktywacji środowiska uruchomieniowego w programie Microsoft .NET Framework 4, programy hosta programu Windows PowerShell, które zostały napisane dla programu Windows PowerShell 2.0 i kompilowane z Common Language Runtime (CLR) w wersji 2.0 nie można uruchomić bez modyfikacji w Windows Program PowerShell 3.0 lub Windows PowerShell 4.0, które są kompilowane przy użyciu środowiska CLR w wersji 4.0.</span><span class="sxs-lookup"><span data-stu-id="3f19b-107">However, due to a change in the runtime activation policy in Microsoft .NET Framework 4, Windows PowerShell host programs that were written for Windows PowerShell 2.0 and compiled with Common Language Runtime (CLR) 2.0 cannot run without modification in Windows PowerShell 3.0 or Windows PowerShell 4.0, which are compiled with CLR 4.0.</span></span> <span data-ttu-id="3f19b-108">Aparatu programu Windows PowerShell 2.0 jest przeznaczona do użycia tylko wtedy, gdy istniejący skrypt lub program hosta nie można uruchomić, ponieważ nie jest zgodny z programu Windows PowerShell 4.0, Windows PowerShell 3.0 lub Microsoft .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="3f19b-108">The Windows PowerShell 2.0 Engine is intended to be used only when an existing script or host program cannot run because it is incompatible with Windows PowerShell 4.0, Windows PowerShell 3.0, or Microsoft .NET Framework 4.</span></span> <span data-ttu-id="3f19b-109">Takiej sytuacji powinny być rzadko.</span><span class="sxs-lookup"><span data-stu-id="3f19b-109">Such cases are expected to be rare.</span></span>

<span data-ttu-id="3f19b-110">Wiele programów, które wymagają aparatu programu Windows PowerShell 2.0 rozpoczynaj automatycznie.</span><span class="sxs-lookup"><span data-stu-id="3f19b-110">Many programs that require the Windows PowerShell 2.0 Engine start it automatically.</span></span> <span data-ttu-id="3f19b-111">Te instrukcje są uwzględnione w rzadkich sytuacjach, w których należy ręcznie uruchomić aparatu.</span><span class="sxs-lookup"><span data-stu-id="3f19b-111">These instructions are included for the rare situations in which you need to start the engine manually.</span></span>

## <a name="installing-and-enabling-required-programs"></a><span data-ttu-id="3f19b-112">Instalowanie i włączanie wymagane programy</span><span class="sxs-lookup"><span data-stu-id="3f19b-112">Installing and Enabling Required Programs</span></span>

<span data-ttu-id="3f19b-113">Przed rozpoczęciem aparatu programu Windows PowerShell 2.0, należy włączyć aparatu programu Windows PowerShell 2.0 i Microsoft .NET Framework 3.5 z dodatkiem Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="3f19b-113">Before starting the Windows PowerShell 2.0 Engine, enable the Windows PowerShell 2.0 Engine and Microsoft .NET Framework 3.5 with Service Pack 1.</span></span> <span data-ttu-id="3f19b-114">Aby uzyskać instrukcje, zobacz [Instalowanie programu Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="3f19b-114">For instructions, see [Installing Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span></span>

<span data-ttu-id="3f19b-115">Systemy, na które Windows Management Framework 4.0 lub Windows Management Framework 3.0 są zainstalowane znajdują się wszystkie wymagane składniki.</span><span class="sxs-lookup"><span data-stu-id="3f19b-115">Systems on which Windows Management Framework 4.0 or Windows Management Framework 3.0 are installed have all of the required components.</span></span> <span data-ttu-id="3f19b-116">Żadna dalsza konfiguracja jest to konieczne.</span><span class="sxs-lookup"><span data-stu-id="3f19b-116">No further configuration is necessary.</span></span> <span data-ttu-id="3f19b-117">Aby uzyskać informacje o instalowaniu [Windows Management Framework 4.0](https://go.microsoft.com/fwlink/?LinkID=293881) lub Windows Management Framework 3.0, zobacz [Instalowanie programu Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="3f19b-117">For information about installing [Windows Management Framework 4.0](https://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0, see [Installing Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span></span>

## <a name="how-to-start-the-windows-powershell-20-engine"></a><span data-ttu-id="3f19b-118">Jak uruchomić aparatu programu Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="3f19b-118">How to start the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="3f19b-119">Po uruchomieniu programu Windows PowerShell to najnowsza wersja uruchamia się domyślnie.</span><span class="sxs-lookup"><span data-stu-id="3f19b-119">When you start Windows PowerShell the newest version starts by default.</span></span> <span data-ttu-id="3f19b-120">Aby uruchomić program Windows PowerShell przy użyciu aparatu programu Windows PowerShell 2.0, należy użyć parametru wersji PowerShell.exe.</span><span class="sxs-lookup"><span data-stu-id="3f19b-120">To start Windows PowerShell with the Windows PowerShell 2.0 Engine, use the Version parameter of PowerShell.exe.</span></span> <span data-ttu-id="3f19b-121">Polecenie można uruchomić dowolnego wiersza polecenia, w tym programu Windows PowerShell i Cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="3f19b-121">You can run the command at any command prompt, including Windows PowerShell and Cmd.exe.</span></span>

```
PowerShell.exe -Version 2
```

## <a name="how-to-start-a-remote-session-with-the-windows-powershell-20-engine"></a><span data-ttu-id="3f19b-122">Jak uruchomić sesję zdalną z aparatu programu Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="3f19b-122">How to start a remote session with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="3f19b-123">Aby uruchomić aparatu programu Windows PowerShell 2.0 w sesji zdalnej, należy utworzyć konfigurację sesji (znany także jako "punkt końcowy") na komputerze zdalnym, który ładuje aparatu programu Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="3f19b-123">To run the Windows PowerShell 2.0 Engine in a remote session, create a session configuration (also known as an "endpoint") on the remote computer that loads the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="3f19b-124">Konfiguracja sesji jest zapisywany na komputerze zdalnym i może służyć przez innych użytkowników autoryzowanych do tworzenia sesji, które używają aparatu programu Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="3f19b-124">The session configuration is saved on the remote computer and can be used by any authorized user to create sessions that use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="3f19b-125">Jest zaawansowanym zadaniem, które jest zazwyczaj wykonywane przez administratora systemu.</span><span class="sxs-lookup"><span data-stu-id="3f19b-125">This is an advanced task that is typically performed by a system administrator.</span></span>

<span data-ttu-id="3f19b-126">W poniższej procedurze użyto **PSVersion** parametru [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) polecenia cmdlet, aby utworzyć konfigurację sesji, która używa aparatu programu Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="3f19b-126">The following procedure uses the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet to create a session configuration that uses the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="3f19b-127">Można również użyć **PowerShellVersion** parametru [New PSSessionConfigurationFile](https://technet.microsoft.com/library/5f3e3633-6e90-479c-aea9-ba45a1954866) polecenia cmdlet, aby utworzyć plik konfiguracji sesji dla sesji, który ładuje aparatu programu Windows PowerShell 2.0 i Możesz użyć **PSVersion** parametru [Set-PSSessionConfiguration](https://technet.microsoft.com/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parametru, aby zmienić konfigurację sesji, aby użyć aparatu programu Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="3f19b-127">You can also use the **PowerShellVersion** parameter of the [New-PSSessionConfigurationFile](https://technet.microsoft.com/library/5f3e3633-6e90-479c-aea9-ba45a1954866) cmdlet to create a session configuration file for a session that loads the Windows PowerShell 2.0 Engine and you can use the **PSVersion** parameter of the [Set-PSSessionConfiguration](https://technet.microsoft.com/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parameter to change a session configuration to use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="3f19b-128">Aby uzyskać więcej informacji o plikach konfiguracji sesji, zobacz [about_Session_Configuration_Files](https://technet.microsoft.com/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8). Aby uzyskać informacje na temat konfiguracji sesji, w tym ustawienia i zabezpieczenia, zobacz [informacje o konfiguracjach sesji [4]](https://technet.microsoft.com/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span><span class="sxs-lookup"><span data-stu-id="3f19b-128">For more information about session configuration files, see [about_Session_Configuration_Files](https://technet.microsoft.com/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8).For information about session configurations, including setup and security, see [about_Session_Configurations[v4]](https://technet.microsoft.com/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span></span>

#### <a name="to-start-a-remote-windows-powershell-20-session"></a><span data-ttu-id="3f19b-129">Aby rozpocząć sesję zdalną programu Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="3f19b-129">To start a remote Windows PowerShell 2.0 session</span></span>

1. <span data-ttu-id="3f19b-130">Aby utworzyć konfigurację sesji, która wymaga aparatu programu Windows PowerShell 2.0, użyj **PSVersion** parametru [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) polecenia cmdlet z wartością "w wersji 2.0".</span><span class="sxs-lookup"><span data-stu-id="3f19b-130">To create a session configuration that requires the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet with a value of "2.0".</span></span> <span data-ttu-id="3f19b-131">Uruchom następujące polecenie na komputerze "po stronie serwera" lub odbieranie koniec połączenia.</span><span class="sxs-lookup"><span data-stu-id="3f19b-131">Run this command on the computer at the "server side" or receiving end of the connection.</span></span>

   <span data-ttu-id="3f19b-132">Następujące przykładowe polecenie umożliwia utworzenie konfiguracji sesji PS2 komputera Serwer01.</span><span class="sxs-lookup"><span data-stu-id="3f19b-132">The following sample command creates the PS2 session configuration on the Server01 computer.</span></span> <span data-ttu-id="3f19b-133">Do uruchomienia tego polecenia, uruchom program Windows PowerShell 4.0 lub programu Windows PowerShell 3.0 za pomocą **Uruchom jako administrator** opcji.</span><span class="sxs-lookup"><span data-stu-id="3f19b-133">To run this command, start Windows PowerShell 4.0 or Windows PowerShell 3.0 with the **Run as administrator** option.</span></span>

   ```powershell
   Register-PSSessionConfiguration -Name PS2 -PSVersion 2.0
   ```

2. <span data-ttu-id="3f19b-134">Aby utworzyć sesję komputera Serwer01, który korzysta z konfiguracji sesji PS2, użyj **ConfigurationName** parametru polecenia cmdlet, które Tworzenie sesji zdalnej, takich jak [New-PSSession](https://technet.microsoft.com/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="3f19b-134">To create a session on the Server01 computer that uses the PS2 session configuration, use the **ConfigurationName** parameter of cmdlets that create a remote session, such as the [New-PSSession](https://technet.microsoft.com/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span></span>

   <span data-ttu-id="3f19b-135">Po uruchomieniu sesji, która korzysta z konfiguracji sesji aparatu programu Windows PowerShell 2.0 jest automatycznie ładowany do sesji.</span><span class="sxs-lookup"><span data-stu-id="3f19b-135">When a session that uses the session configuration starts, the Windows PowerShell 2.0 Engine is automatically loaded into the session.</span></span>

   <span data-ttu-id="3f19b-136">Następujące polecenie uruchamia sesję komputera Serwer01, który korzysta z konfiguracji sesji PS2.</span><span class="sxs-lookup"><span data-stu-id="3f19b-136">The following command starts a session on the Server01 computer that uses the PS2 session configuration.</span></span> <span data-ttu-id="3f19b-137">Polecenie zapisuje tę sesję w zmiennej $s.</span><span class="sxs-lookup"><span data-stu-id="3f19b-137">The command saves the session in the $s variable.</span></span>

   ```powershell
   $s = New-PSSession -ComputerName Server01 -ConfigurationName PS2
   ```

## <a name="how-to-start-a-background-job-with-the-windows-powershell-20-engine"></a><span data-ttu-id="3f19b-138">Jak uruchomić zadanie w tle za pomocą aparatu programu Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="3f19b-138">How to start a background job with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="3f19b-139">Aby rozpocząć zadanie w tle za pomocą aparatu programu Windows PowerShell 2.0, użyj **PSVersion** parametru [zadanie rozpoczęcia](https://technet.microsoft.com/library/2bc04935-0deb-4ec0-b856-d7290cca6442) polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="3f19b-139">To start a background job with the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Start-Job](https://technet.microsoft.com/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span></span>

<span data-ttu-id="3f19b-140">Następujące polecenie uruchamia zadanie w tle za pomocą aparatu programu Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="3f19b-140">The following command starts a background job with the Windows PowerShell 2.0 Engine</span></span>

```powershell
Start-Job {Get-Process} -PSVersion 2.0
```

<span data-ttu-id="3f19b-141">Aby uzyskać więcej informacji na temat zadań w tle, zobacz [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span><span class="sxs-lookup"><span data-stu-id="3f19b-141">For more information about background jobs, see [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span></span>